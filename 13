"use strict";
(self.webpackChunk_N_E = self.webpackChunk_N_E || []).push([[6294], {
    7618: function(e, t, o) {
        var s = o(7437)
          , r = o(2265)
          , a = o(5978)
          , n = o(6410)
          , i = o(4362)
          , l = o(3504)
          , d = o(2130);
        t.Z = e => {
            let {isOpen: t, onClose: o, onJobReassigned: c, job: u, jobs: m} = e
              , {user: h, company: x} = (0,
            i.a)()
              , {addNotification: b} = (0,
            l.z)()
              , [p,g] = (0,
            r.useState)(!1)
              , [j,f] = (0,
            r.useState)("")
              , [y,v] = (0,
            r.useState)("")
              , [N,D] = (0,
            r.useState)(!1)
              , [w,C] = (0,
            r.useState)([])
              , [k,I] = (0,
            r.useState)("")
              , [S,T] = (0,
            r.useState)(!1)
              , P = (0,
            r.useRef)(null)
              , E = m && m.length > 0
              , L = E ? m : u ? [u] : [];
            (0,
            r.useEffect)( () => {
                t && x && A()
            }
            , [t, x]),
            (0,
            r.useEffect)( () => {
                let e = e => {
                    P.current && !P.current.contains(e.target) && T(!1)
                }
                ;
                return document.addEventListener("mousedown", e),
                () => {
                    document.removeEventListener("mousedown", e)
                }
            }
            , []),
            (0,
            r.useEffect)( () => () => {}
            , [t]);
            let A = async () => {
                try {
                    let e = (0,
                    a.collection)(n.db, "companies", x.companyId, "users")
                      , t = (await (0,
                    a.getDocs)(e)).docs.map(e => ({
                        id: e.id,
                        ...e.data()
                    })).filter(e => "tech" === e.role || e.techNumber);
                    C(t)
                } catch (e) {
                    console.error("Error loading techs:", e)
                }
            }
              , J = async e => {
                if (e.preventDefault(),
                x && h && 0 !== L.length) {
                    if (!j) {
                        b({
                            title: "Error",
                            body: "Please select a technician to reassign the job(s) to",
                            type: "error"
                        });
                        return
                    }
                    if (L.some(e => j === e.assignedUserId)) {
                        b({
                            title: "Error",
                            body: "One or more jobs are already assigned to the selected technician",
                            type: "error"
                        });
                        return
                    }
                    g(!0);
                    try {
                        let e = w.find(e => e.id === j)
                          , t = e ? "".concat(e.firstName, " ").concat(e.lastName) : "Unknown";
                        for (let e of L) {
                            let t = {
                                jobId: e.jobId,
                                jobDocumentId: e.id,
                                newTechId: j,
                                transferNotes: y,
                                isExternalReassignment: N,
                                originTechId: e.assignedUserId,
                                originTechNumber: ""
                            };
                            await (0,
                            d.Gn)(x.companyId, t, h.id, "".concat(h.firstName, " ").concat(h.lastName))
                        }
                        let o = L.length
                          , s = 1 === o ? "Job ".concat(L[0].jobId, " has been reassigned to ").concat(t) : "".concat(o, " jobs have been reassigned to ").concat(t);
                        b({
                            title: 1 === o ? "Job Reassigned" : "Jobs Reassigned",
                            body: s,
                            type: "success"
                        }),
                        c(),
                        U()
                    } catch (e) {
                        console.error("Error reassigning job(s):", e),
                        b({
                            title: "Error",
                            body: e instanceof Error ? e.message : "Failed to reassign job(s)",
                            type: "error"
                        })
                    } finally {
                        g(!1)
                    }
                }
            }
              , U = () => {
                f(""),
                v(""),
                D(!1),
                I(""),
                T(!1),
                o()
            }
              , R = w.filter(e => {
                if (!k)
                    return !L.some(t => e.id === t.assignedTechId);
                let t = "".concat(e.firstName, " ").concat(e.lastName).toLowerCase()
                  , o = (e.techNumber || e.techId || "").toString().toLowerCase()
                  , s = t.includes(k.toLowerCase()) || o.includes(k.toLowerCase())
                  , r = L.some(t => e.id === t.assignedTechId);
                return s && !r
            }
            )
              , M = w.find(e => e.id === j)
              , F = M ? "".concat(M.firstName, " ").concat(M.lastName, " (Tech #").concat(M.techNumber || M.techId || "Unknown", ")") : ""
              , O = e => {
                f(e),
                T(!1),
                I("")
            }
            ;
            if (!t || 0 === L.length)
                return null;
            let V = L[0]
              , B = w.find(e => e.id === V.assignedTechId)
              , z = E && L.length > 1 ? "Multiple Technicians" : B ? "".concat(B.firstName, " ").concat(B.lastName, " (Tech #").concat(B.techNumber || B.techId || "Unknown", ")") : "Unknown Technician";
            return (0,
            s.jsx)("div", {
                className: "modal-container",
                children: (0,
                s.jsx)("div", {
                    className: "modal-content max-w-lg mx-4",
                    children: (0,
                    s.jsxs)("div", {
                        className: "p-6",
                        children: [(0,
                        s.jsxs)("div", {
                            className: "flex items-center justify-between mb-6",
                            children: [(0,
                            s.jsx)("h2", {
                                className: "text-2xl font-bold text-gray-900",
                                children: E ? "Reassign ".concat(L.length, " Jobs") : "Reassign Job"
                            }), (0,
                            s.jsx)("button", {
                                onClick: U,
                                className: "text-gray-400 hover:text-gray-600 transition-colors",
                                children: (0,
                                s.jsx)("svg", {
                                    className: "w-6 h-6",
                                    fill: "none",
                                    stroke: "currentColor",
                                    viewBox: "0 0 24 24",
                                    children: (0,
                                    s.jsx)("path", {
                                        strokeLinecap: "round",
                                        strokeLinejoin: "round",
                                        strokeWidth: 2,
                                        d: "M6 18L18 6M6 6l12 12"
                                    })
                                })
                            })]
                        }), (0,
                        s.jsxs)("div", {
                            className: "mb-6 p-4 bg-gray-50 rounded-lg",
                            children: [(0,
                            s.jsx)("h3", {
                                className: "font-medium text-gray-900 mb-2",
                                children: E ? "Jobs Details" : "Job Details"
                            }), E ? (0,
                            s.jsxs)("div", {
                                className: "text-sm text-gray-600 space-y-2",
                                children: [(0,
                                s.jsxs)("p", {
                                    children: [(0,
                                    s.jsx)("strong", {
                                        children: "Number of Jobs:"
                                    }), " ", L.length]
                                }), (0,
                                s.jsxs)("p", {
                                    children: [(0,
                                    s.jsx)("strong", {
                                        children: "Job IDs:"
                                    }), " ", L.map(e => e.jobId).join(", ")]
                                }), (0,
                                s.jsxs)("p", {
                                    children: [(0,
                                    s.jsx)("strong", {
                                        children: "Currently Assigned To:"
                                    }), " ", z]
                                }), (0,
                                s.jsxs)("div", {
                                    className: "mt-3",
                                    children: [(0,
                                    s.jsx)("p", {
                                        children: (0,
                                        s.jsx)("strong", {
                                            children: "Jobs Summary:"
                                        })
                                    }), (0,
                                    s.jsx)("div", {
                                        className: "max-h-32 overflow-y-auto mt-1 space-y-1",
                                        children: L.map( (e, t) => (0,
                                        s.jsxs)("div", {
                                            className: "text-xs bg-white p-2 rounded border",
                                            children: [(0,
                                            s.jsx)("span", {
                                                className: "font-medium",
                                                children: e.jobId
                                            }), " - ", e.customerName, " (", e.address, ")"]
                                        }, t))
                                    })]
                                })]
                            }) : (0,
                            s.jsxs)("div", {
                                className: "text-sm text-gray-600 space-y-1",
                                children: [(0,
                                s.jsxs)("p", {
                                    children: [(0,
                                    s.jsx)("strong", {
                                        children: "Job ID:"
                                    }), " ", V.jobId]
                                }), (0,
                                s.jsxs)("p", {
                                    children: [(0,
                                    s.jsx)("strong", {
                                        children: "Customer:"
                                    }), " ", V.customerName]
                                }), (0,
                                s.jsxs)("p", {
                                    children: [(0,
                                    s.jsx)("strong", {
                                        children: "Address:"
                                    }), " ", V.address]
                                }), (0,
                                s.jsxs)("p", {
                                    children: [(0,
                                    s.jsx)("strong", {
                                        children: "Type:"
                                    }), " ", V.type]
                                }), (0,
                                s.jsxs)("p", {
                                    children: [(0,
                                    s.jsx)("strong", {
                                        children: "Current Status:"
                                    }), " ", V.status]
                                }), (0,
                                s.jsxs)("p", {
                                    children: [(0,
                                    s.jsx)("strong", {
                                        children: "Currently Assigned To:"
                                    }), " ", z]
                                })]
                            })]
                        }), (0,
                        s.jsxs)("form", {
                            onSubmit: J,
                            className: "space-y-4",
                            children: [(0,
                            s.jsxs)("div", {
                                className: "relative",
                                ref: P,
                                children: [(0,
                                s.jsx)("label", {
                                    className: "block text-sm font-medium text-gray-700 mb-1",
                                    children: "Reassign To *"
                                }), (0,
                                s.jsxs)("div", {
                                    className: "relative",
                                    children: [(0,
                                    s.jsx)("input", {
                                        type: "text",
                                        value: j ? F : k,
                                        onChange: e => {
                                            I(e.target.value),
                                            T(!0),
                                            j && f("")
                                        }
                                        ,
                                        onFocus: () => T(!0),
                                        placeholder: "Search technicians...",
                                        className: "w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",
                                        required: !0
                                    }), (0,
                                    s.jsx)("div", {
                                        className: "absolute inset-y-0 right-0 flex items-center pr-3",
                                        children: (0,
                                        s.jsx)("svg", {
                                            className: "w-5 h-5 text-gray-400",
                                            fill: "none",
                                            stroke: "currentColor",
                                            viewBox: "0 0 24 24",
                                            children: (0,
                                            s.jsx)("path", {
                                                strokeLinecap: "round",
                                                strokeLinejoin: "round",
                                                strokeWidth: 2,
                                                d: "M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
                                            })
                                        })
                                    })]
                                }), S && (0,
                                s.jsx)("div", {
                                    className: "absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-auto",
                                    children: 0 === R.length ? (0,
                                    s.jsx)("div", {
                                        className: "px-3 py-2 text-sm text-gray-500",
                                        children: "No available technicians found"
                                    }) : R.map(e => (0,
                                    s.jsxs)("button", {
                                        type: "button",
                                        onClick: () => O(e.id),
                                        className: "w-full text-left px-3 py-2 text-sm hover:bg-gray-100 focus:bg-gray-100 focus:outline-none",
                                        children: [e.firstName, " ", e.lastName, " (Tech #", e.techNumber || e.techId || "Unknown", ")"]
                                    }, e.id))
                                })]
                            }), (0,
                            s.jsxs)("div", {
                                children: [(0,
                                s.jsx)("label", {
                                    className: "block text-sm font-medium text-gray-700 mb-1",
                                    children: "Transfer Notes"
                                }), (0,
                                s.jsx)("textarea", {
                                    value: y,
                                    onChange: e => v(e.target.value),
                                    rows: 3,
                                    placeholder: E ? "Optional notes about the bulk reassignment..." : "Optional notes about the reassignment...",
                                    className: "w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                                })]
                            }), (0,
                            s.jsx)("div", {
                                className: "space-y-4",
                                children: (0,
                                s.jsxs)("div", {
                                    className: "flex items-center",
                                    children: [(0,
                                    s.jsx)("input", {
                                        type: "checkbox",
                                        id: "isExternalReassignment",
                                        checked: N,
                                        onChange: e => D(e.target.checked),
                                        className: "h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"
                                    }), (0,
                                    s.jsx)("label", {
                                        htmlFor: "isExternalReassignment",
                                        className: "ml-2 text-sm text-gray-700",
                                        children: "This is an external reassignment"
                                    })]
                                })
                            }), (0,
                            s.jsxs)("div", {
                                className: "flex justify-end space-x-3 pt-6 border-t",
                                children: [(0,
                                s.jsx)("button", {
                                    type: "button",
                                    onClick: U,
                                    className: "px-4 py-2 text-gray-700 bg-gray-200 rounded-md hover:bg-gray-300 transition-colors",
                                    children: "Cancel"
                                }), (0,
                                s.jsx)("button", {
                                    type: "submit",
                                    disabled: p || !j,
                                    className: "px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",
                                    children: p ? E ? "Reassigning Jobs..." : "Reassigning..." : E ? "Reassign ".concat(L.length, " Jobs") : "Reassign Job"
                                })]
                            })]
                        })]
                    })
                })
            })
        }
    },
    6294: function(e, t, o) {
        o.d(t, {
            Z: function() {
                return w
            }
        });
        var s, r, a = o(7437), n = o(2265), i = o(4362), l = o(3504), d = o(3050), c = o(3496), u = o(2130), m = o(5978), h = o(6410);
        async function x(e, t, o) {
            try {
                var s, r;
                console.log("\uD83D\uDD0D Duplicate Detection - Checking for duplicate job:", {
                    companyId: e,
                    jobNumber: t,
                    catvProvider: o
                });
                let a = (0,
                m.collection)(h.db, "companies", e, "jobs")
                  , n = (0,
                m.query)(a, (0,
                m.where)("jobId", "==", t), (0,
                m.orderBy)("createdAt", "desc"), (0,
                m.limit)(5))
                  , i = await (0,
                m.getDocs)(n);
                if (console.log("\uD83D\uDD0D Duplicate Detection - Query results:", {
                    totalJobs: i.size,
                    jobNumber: t
                }),
                i.empty)
                    return console.log("✅ Duplicate Detection - No duplicate found"),
                    {
                        hasDuplicate: !1
                    };
                let l = i.docs.filter(e => {
                    let t = e.data();
                    return "deleted" === t.status ? (console.log("\uD83D\uDEAB Skipping deleted job:", e.id),
                    !1) : t.address && t.customerName ? (!0 === t.archived && console.log("\uD83D\uDCC1 Including archived job in duplicate search:", e.id),
                    !0) : (console.log("\uD83D\uDEAB Skipping incomplete job (missing address or customer):", e.id),
                    !1)
                }
                );
                if (0 === l.length)
                    return console.log("✅ Duplicate Detection - No valid duplicates found (all filtered out)"),
                    {
                        hasDuplicate: !1
                    };
                let d = l[0]
                  , c = d.data();
                console.log("\uD83D\uDD0D Duplicate Detection - Raw database data:", {
                    jobId: c.jobId,
                    status: c.status,
                    catvProvider: c.catvProvider,
                    createdAt: c.createdAt,
                    unitNumber: c.unitNumber,
                    unitNumberType: typeof c.unitNumber,
                    unitNumberValue: JSON.stringify(c.unitNumber),
                    allFields: Object.keys(c),
                    rawDocumentData: c
                }),
                console.error("\uD83D\uDEA8 DATABASE DOCUMENT ANALYSIS \uD83D\uDEA8", {
                    documentId: d.id,
                    hasUnitNumber: "unitNumber"in c,
                    unitNumberValue: c.unitNumber,
                    allFieldNames: Object.keys(c).sort(),
                    fieldsContainingUnit: Object.keys(c).filter(e => e.toLowerCase().includes("unit")),
                    completeDocument: JSON.stringify(c, null, 2)
                });
                let u = function(e, t) {
                    if (!e || !t)
                        return !1;
                    let o = e => e.toLowerCase().trim();
                    return o(e) === o(t)
                }(o, c.catvProvider || "");
                if (console.log("\uD83D\uDD0D Duplicate Detection - CATV provider check:", {
                    currentCatvProvider: o,
                    jobCatvProvider: c.catvProvider,
                    match: u
                }),
                !u)
                    return console.log("❌ Duplicate Detection - CATV providers don't match, not a duplicate"),
                    {
                        hasDuplicate: !1
                    };
                let x = {
                    id: d.id,
                    jobId: c.jobId,
                    type: c.type || "",
                    address: c.address || "",
                    unitNumber: c.unitNumber,
                    city: c.city || "",
                    customerName: c.customerName || "",
                    customerPhone: c.customerPhone || "",
                    timeFrame: c.timeFrame || "",
                    priority: c.priority || "medium",
                    description: c.description,
                    notes: c.notes,
                    catvProvider: c.catvProvider,
                    workSkill: c.workSkill,
                    additionalPhone: c.additionalPhone,
                    comment: c.comment,
                    dispatchComment: c.dispatchComment,
                    units: c.units,
                    fullAccountNumber: c.fullAccountNumber,
                    resolutionCodes: c.resolutionCodes,
                    createdAt: (null === (r = c.createdAt) || void 0 === r ? void 0 : null === (s = r.toDate) || void 0 === s ? void 0 : s.call(r)) || new Date,
                    assignedTechName: c.assignedTechName,
                    assignedTechNumber: c.assignedTechNumber
                };
                return console.log("✅ Duplicate Detection - Duplicate job found:", {
                    duplicateJob: x,
                    message: "Found existing job ".concat(t, " with matching CATV provider")
                }),
                {
                    hasDuplicate: !0,
                    duplicateJob: x,
                    message: "Duplicate job detected: Job ".concat(t, " already exists with the same CATV provider."),
                    suggestion: "Would you like to copy information from the existing job?"
                }
            } catch (e) {
                return console.error("❌ Duplicate Detection - Error checking for duplicate job:", e),
                {
                    hasDuplicate: !1
                }
            }
        }
        (s = r || (r = {})).PENDING = "pending",
        s.ASSIGNED = "assigned",
        s.ASSIGNED_INTERNAL = "assigned-internal",
        s.IN_PROGRESS = "in-progress",
        s.COMPLETED = "completed",
        s.CANCELLED = "cancelled",
        s.EXTERNALLY_UNASSIGNED = "externally_unassigned",
        s.REFERENCE = "reference",
        s.UNASSIGNED = "unassigned",
        s.CLAIMED = "claimed",
        s.APPROVED = "approved";
        var b = o(1022);
        let p = () => {
            let[e,t] = (0,
            n.useState)({
                isValidating: !1,
                isValid: null,
                error: null,
                coordinates: null,
                geocodeResult: null,
                isManualLocation: !1
            })
              , o = (0,
            n.useRef)();
            return {
                validationState: e,
                validateAddress: (0,
                n.useCallback)(async (e, s) => {
                    if (console.log("\uD83D\uDCCD ADDRESS VALIDATION CALLED:", {
                        address: e,
                        city: s
                    }),
                    o.current && clearTimeout(o.current),
                    !e.trim() || !s.trim() || e.length < 3 || s.length < 2) {
                        console.log("❌ ADDRESS VALIDATION SKIPPED - too short or empty"),
                        t({
                            isValidating: !1,
                            isValid: null,
                            error: null,
                            coordinates: null,
                            geocodeResult: null,
                            isManualLocation: !1
                        });
                        return
                    }
                    t(e => ({
                        ...e,
                        isValidating: !0,
                        error: null,
                        geocodeResult: null,
                        isManualLocation: !1
                    })),
                    o.current = setTimeout(async () => {
                        try {
                            let o = await (0,
                            b.gA)(e.trim(), s.trim());
                            console.log("✅ ADDRESS VALIDATION RESULT:", {
                                inputAddress: "".concat(e.trim(), ", ").concat(s.trim()),
                                geocodeResult: o,
                                coordinates: null == o ? void 0 : o.coordinates
                            }),
                            t({
                                isValidating: !1,
                                isValid: !!o,
                                error: o ? null : "Address not found. Please check the address and city.",
                                coordinates: (null == o ? void 0 : o.coordinates) || null,
                                geocodeResult: o,
                                isManualLocation: !1
                            })
                        } catch (e) {
                            console.error("Address validation error:", e),
                            t({
                                isValidating: !1,
                                isValid: !1,
                                error: "Unable to validate address. Please try again.",
                                coordinates: null,
                                geocodeResult: null,
                                isManualLocation: !1
                            })
                        }
                    }
                    , 500)
                }
                , []),
                resetValidation: (0,
                n.useCallback)( () => {
                    o.current && clearTimeout(o.current),
                    t({
                        isValidating: !1,
                        isValid: null,
                        error: null,
                        coordinates: null,
                        geocodeResult: null,
                        isManualLocation: !1
                    })
                }
                , []),
                setManualCoordinates: (0,
                n.useCallback)(e => {
                    o.current && clearTimeout(o.current),
                    t({
                        isValidating: !1,
                        isValid: !0,
                        error: null,
                        coordinates: e,
                        geocodeResult: null,
                        isManualLocation: !0
                    })
                }
                , [])
            }
        }
        ;
        var g = o(3005)
          , j = o(3055)
          , f = o(6553)
          , y = o(7618)
          , v = o(4526)
          , N = o(2832)
          , D = o(2);
        function w(e) {
            var t, o, s;
            let b;
            let {isOpen: w, onClose: k, onJobUpdated: I, mode: S, context: T, selectedJob: P, selectedTech: E, isArchivedJob: L=!1, scheduleDateFilter: A, forceDefaultFields: J=!1} = e
              , {company: U, user: R} = (0,
            i.a)()
              , {addNotification: M} = (0,
            l.z)()
              , {isMobile: F} = (0,
            d.h)()
              , O = (0,
            n.useMemo)( () => {
                if (J)
                    return !1;
                let e = "";
                if ("create" === S && E) {
                    let t = "altice/optimum" === (e = (E.catvProvider || "").toLowerCase());
                    return console.log("\uD83D\uDD0D Provider Detection (Create Mode):", {
                        mode: S,
                        techName: E.name,
                        catvProvider: E.catvProvider,
                        normalized: e,
                        isAlticeOptimum: t
                    }),
                    t
                }
                if ("manage" === S && (P || E)) {
                    let t = "altice/optimum" === (e = ((null == P ? void 0 : P.catvProvider) || (null == E ? void 0 : E.catvProvider) || "").toLowerCase());
                    return console.log("\uD83D\uDD0D Provider Detection (Manage Mode):", {
                        mode: S,
                        jobId: null == P ? void 0 : P.jobId,
                        jobCatvProvider: null == P ? void 0 : P.catvProvider,
                        techCatvProvider: null == E ? void 0 : E.catvProvider,
                        normalized: e,
                        isAlticeOptimum: t
                    }),
                    t
                }
                return !1
            }
            , [J, S, E, P])
              , [V,B] = (0,
            n.useState)(!1)
              , [z,Q] = (0,
            n.useState)(!1)
              , [W,G] = (0,
            n.useState)(!1)
              , [_,H] = (0,
            n.useState)(!1)
              , [q,Y] = (0,
            n.useState)(!1)
              , [Z,X] = (0,
            n.useState)(!1)
              , [K,$] = (0,
            n.useState)(!1)
              , [ee,et] = (0,
            n.useState)(!1)
              , [eo,es] = (0,
            n.useState)(null)
              , [er,ea] = (0,
            n.useState)("")
              , [en,ei] = (0,
            n.useState)([])
              , [el,ed] = (0,
            n.useState)([])
              , [ec,eu] = (0,
            n.useState)([])
              , [em,eh] = (0,
            n.useState)({})
              , [ex,eb] = (0,
            n.useState)([])
              , [ep,eg] = (0,
            n.useState)("create")
              , [ej,ef] = (0,
            n.useState)(!1)
              , [ey,ev] = (0,
            n.useState)([])
              , [eN,eD] = (0,
            n.useState)(!1)
              , ew = (null == R ? void 0 : R.role) === "dispatcher" || (null == R ? void 0 : R.role) === "admin"
              , eC = (null == R ? void 0 : R.role) === "admin"
              , ek = (0,
            n.useCallback)(async (e, t) => {
                if (U && P) {
                    if (!eC) {
                        M({
                            title: "Permission Denied",
                            body: "Only admin can delete photos.",
                            type: "error"
                        });
                        return
                    }
                    if (window.confirm("Delete this photo permanently?"))
                        try {
                            var o;
                            await (0,
                            c.iP)(U.companyId, P.id, t, e),
                            M({
                                title: "Photo Deleted",
                                body: "The photo was removed.",
                                type: "success"
                            });
                            let s = "completion" === e ? "completionPhotos" : "selfQCPhotos"
                              , r = (null === (o = P[s]) || void 0 === o ? void 0 : o.filter(e => e !== t)) || [];
                            I({
                                ...P,
                                [s]: r
                            })
                        } catch (e) {
                            console.error("Error deleting photo:", e),
                            M({
                                title: "Delete Failed",
                                body: "Could not delete photo.",
                                type: "error"
                            })
                        }
                }
            }
            , [U, P, M, I, eC])
              , [eI,eS] = (0,
            n.useState)({
                hasDuplicate: !1
            })
              , [eT,eP] = (0,
            n.useState)(!1)
              , [eE,eL] = (0,
            n.useState)(!1)
              , [eA,eJ] = (0,
            n.useState)(0)
              , [eU,eR] = (0,
            n.useState)(!1)
              , [eM,eF] = (0,
            n.useState)(0)
              , [eO,eV] = (0,
            n.useState)(0)
              , [eB,ez] = (0,
            n.useState)(E || null)
              , [eQ,eW] = (0,
            n.useState)("")
              , [eG,e_] = (0,
            n.useState)(!1)
              , eH = (0,
            n.useRef)(null)
              , {validationState: eq, validateAddress: eY, resetValidation: eZ, setManualCoordinates: eX} = p()
              , [eK,e$] = (0,
            n.useState)({
                jobId: "",
                title: "",
                description: "",
                address: "",
                unitNumber: "",
                city: "",
                state: "",
                zipCode: "",
                customerName: "",
                customerPhone: "",
                customerEmail: "",
                jobType: "",
                priority: "medium",
                timeFrame: "",
                estimatedDuration: 60,
                notes: "",
                catvProvider: (null == U ? void 0 : null === (t = U.catvProviders) || void 0 === t ? void 0 : t[0]) || "",
                workSkill: "",
                originalId: "",
                scheduleDate: new Date().toISOString().split("T")[0],
                coordinates: void 0,
                additionalPhone: "",
                comment: "",
                dispatchComment: "",
                units: void 0,
                staticStatus: "",
                staticCompletionTime: "",
                fullAccountNumber: "",
                resolutionCodes: ""
            })
              , [e0,e2] = (0,
            n.useState)({
                jobId: "",
                type: "",
                address: "",
                unitNumber: "",
                city: "",
                customerName: "",
                customerPhone: "",
                timeFrame: "",
                description: "",
                workSkill: "",
                jobOrigin: "",
                priority: "medium",
                scheduleDate: new Date().toISOString().split("T")[0],
                coordinates: void 0
            });
            (0,
            n.useEffect)( () => {
                let e;
                if (!U || !U.companyId)
                    return;
                let t = (0,
                m.collection)(h.db, "companies", U.companyId, "users")
                  , o = (0,
                m.query)(t, (0,
                m.where)("role", "==", "tech"), (0,
                m.where)("archived", "!=", !0));
                return (async () => {
                    try {
                        let e = (await (0,
                        m.getDocs)(o)).docs.map(e => ({
                            id: e.id,
                            ...e.data()
                        }));
                        ed(e),
                        console.log("\uD83D\uDD0D Techs loaded (initial):", e.length)
                    } catch (e) {
                        console.error("Error loading techs:", e)
                    }
                }
                )(),
                "manage" === S && (e = (0,
                m.onSnapshot)(o, e => {
                    let t = e.docs.map(e => ({
                        id: e.id,
                        ...e.data()
                    }));
                    ed(t),
                    console.log("\uD83D\uDD0D Techs updated (real-time):", t.length)
                }
                )),
                () => {
                    e && e()
                }
            }
            , [U, S]),
            (0,
            n.useEffect)( () => {}
            , [P]),
            (0,
            n.useEffect)( () => {
                let e;
                if (!U || !U.companyId || L)
                    return;
                let t = (0,
                m.collection)(h.db, "companies", U.companyId, "jobs")
                  , o = (0,
                m.query)(t, (0,
                m.where)("archived", "!=", !0));
                return A && "map" === T && (o = (0,
                m.query)(t, (0,
                m.where)("archived", "!=", !0), (0,
                m.where)("scheduleDate", "==", A))),
                (async () => {
                    try {
                        let e = (await (0,
                        m.getDocs)(o)).docs.map(e => {
                            let t = e.data();
                            return {
                                id: e.id,
                                ...t,
                                completionPhotos: t.completionPhotos ? [...t.completionPhotos] : void 0,
                                selfQCPhotos: t.selfQCPhotos ? [...t.selfQCPhotos] : void 0,
                                auditLogs: t.auditLogs ? t.auditLogs.map(e => ({
                                    ...e,
                                    completionPhotos: e.completionPhotos ? [...e.completionPhotos] : void 0,
                                    selfQCPhotos: e.selfQCPhotos ? [...e.selfQCPhotos] : void 0
                                })) : void 0
                            }
                        }
                        )
                          , t = {};
                        el.forEach(o => {
                            t[o.id] = e.filter(e => e.assignedTechId === o.id)
                        }
                        ),
                        eu([]),
                        eh(t),
                        console.log("\uD83D\uDD0D Jobs loaded (initial):", {
                            total: e.length,
                            techRoutes: Object.keys(t).length
                        })
                    } catch (e) {
                        console.error("Error loading jobs:", e)
                    }
                }
                )(),
                ("manage" === S || "map" === T) && (e = (0,
                m.onSnapshot)(o, e => {
                    let t = e.docs.map(e => {
                        let t = e.data();
                        return {
                            id: e.id,
                            ...t,
                            completionPhotos: t.completionPhotos ? [...t.completionPhotos] : void 0,
                            selfQCPhotos: t.selfQCPhotos ? [...t.selfQCPhotos] : void 0,
                            auditLogs: t.auditLogs ? t.auditLogs.map(e => ({
                                ...e,
                                completionPhotos: e.completionPhotos ? [...e.completionPhotos] : void 0,
                                selfQCPhotos: e.selfQCPhotos ? [...e.selfQCPhotos] : void 0
                            })) : void 0
                        }
                    }
                    )
                      , o = {};
                    el.forEach(e => {
                        o[e.id] = t.filter(t => t.assignedTechId === e.id)
                    }
                    ),
                    eu([]),
                    eh(o),
                    console.log("\uD83D\uDD0D Jobs updated (real-time):", {
                        total: t.length,
                        techRoutes: Object.keys(o).length
                    })
                }
                )),
                () => {
                    e && e()
                }
            }
            , [U, el, L, A, T, S]),
            (0,
            n.useEffect)( () => {
                let e;
                if (!U || !U.companyId || "archive" !== T && !L)
                    return;
                let t = (0,
                m.collection)(h.db, "companies", U.companyId, "archivedJobs")
                  , o = (0,
                m.query)(t, (0,
                m.orderBy)("createdAt", "desc"), (0,
                m.limit)(50));
                return (async () => {
                    try {
                        let e = (await (0,
                        m.getDocs)(o)).docs.map(e => {
                            let t = e.data();
                            return {
                                id: e.id,
                                ...t,
                                completionPhotos: t.completionPhotos ? [...t.completionPhotos] : void 0,
                                selfQCPhotos: t.selfQCPhotos ? [...t.selfQCPhotos] : void 0,
                                auditLogs: t.auditLogs ? t.auditLogs.map(e => ({
                                    ...e,
                                    completionPhotos: e.completionPhotos ? [...e.completionPhotos] : void 0,
                                    selfQCPhotos: e.selfQCPhotos ? [...e.selfQCPhotos] : void 0
                                })) : void 0
                            }
                        }
                        );
                        eb(e),
                        console.log("\uD83D\uDD0D Archived jobs loaded (initial):", e.length)
                    } catch (e) {
                        console.error("Error loading archived jobs:", e)
                    }
                }
                )(),
                "archive" === T && "manage" === S && (e = (0,
                m.onSnapshot)(o, e => {
                    let t = e.docs.map(e => {
                        let t = e.data();
                        return {
                            id: e.id,
                            ...t,
                            completionPhotos: t.completionPhotos ? [...t.completionPhotos] : void 0,
                            selfQCPhotos: t.selfQCPhotos ? [...t.selfQCPhotos] : void 0,
                            auditLogs: t.auditLogs ? t.auditLogs.map(e => ({
                                ...e,
                                completionPhotos: e.completionPhotos ? [...e.completionPhotos] : void 0,
                                selfQCPhotos: e.selfQCPhotos ? [...e.selfQCPhotos] : void 0
                            })) : void 0
                        }
                    }
                    );
                    eb(t),
                    console.log("\uD83D\uDD0D Archived jobs updated (real-time):", t.length)
                }
                )),
                () => {
                    e && e()
                }
            }
            , [U, T, L, S]),
            (0,
            n.useEffect)( () => {
                if (!U || !U.companyId || !P)
                    return;
                let e = (0,
                m.doc)(h.db, "companies", U.companyId, "jobs", P.id)
                  , t = (0,
                m.onSnapshot)(e, e => {
                    if (e.exists()) {
                        let t = C(e.data())
                          , o = {
                            id: e.id,
                            ...t
                        };
                        es(o),
                        console.log("\uD83D\uDD0D Job updated (specific document):", o.jobId)
                    } else {
                        let e = (0,
                        m.doc)(h.db, "companies", U.companyId, "archivedJobs", P.id);
                        (0,
                        m.getDoc)(e).then(e => {
                            if (e.exists()) {
                                let t = C(e.data())
                                  , o = {
                                    id: e.id,
                                    ...t
                                };
                                es(o),
                                console.log("\uD83D\uDD0D Job found in archives:", o.jobId)
                            } else
                                console.log("\uD83D\uDD0D Job not found in active or archived collections"),
                                es(null)
                        }
                        )
                    }
                }
                );
                return () => t()
            }
            , [U, P]),
            (0,
            n.useEffect)( () => {
                P && e2({
                    jobId: P.jobId,
                    type: P.type || "",
                    address: P.address,
                    unitNumber: P.unitNumber || "",
                    city: P.city,
                    customerName: P.customerName,
                    customerPhone: P.customerPhone,
                    timeFrame: P.timeFrame,
                    description: P.description || "",
                    workSkill: P.workSkill || "",
                    jobOrigin: P.jobOrigin || "",
                    priority: P.priority || "medium",
                    scheduleDate: ( () => {
                        if (!P.scheduleDate)
                            return new Date().toISOString().split("T")[0];
                        try {
                            if ("string" == typeof P.scheduleDate)
                                return P.scheduleDate;
                            if (P.scheduleDate.toDate && "function" == typeof P.scheduleDate.toDate)
                                return P.scheduleDate.toDate().toISOString().split("T")[0];
                            if (P.scheduleDate instanceof Date)
                                return P.scheduleDate.toISOString().split("T")[0];
                            if (P.scheduleDate.seconds)
                                return new Date(1e3 * P.scheduleDate.seconds).toISOString().split("T")[0];
                            return new Date(P.scheduleDate).toISOString().split("T")[0]
                        } catch (e) {
                            return console.warn("Error converting selectedJob.scheduleDate:", P.scheduleDate, e),
                            new Date().toISOString().split("T")[0]
                        }
                    }
                    )(),
                    coordinates: P.coordinates,
                    additionalPhone: P.additionalPhone || "",
                    comment: P.comment || "",
                    dispatchComment: P.dispatchComment || "",
                    units: P.units || void 0,
                    staticStatus: P.staticStatus || "",
                    staticCompletionTime: P.staticCompletionTime || "",
                    fullAccountNumber: P.fullAccountNumber || "",
                    resolutionCodes: P.resolutionCodes || ""
                })
            }
            , [P]),
            (0,
            n.useEffect)( () => {
                w && "manage" === S && eg("manage")
            }
            , [w, S]),
            (0,
            n.useEffect)( () => {
                if (w && (ef(!1),
                "create" === S)) {
                    var e;
                    ez(null),
                    eW(""),
                    e_(!1),
                    e$({
                        jobId: "",
                        title: "",
                        description: "",
                        address: "",
                        unitNumber: "",
                        city: "",
                        state: "",
                        zipCode: "",
                        customerName: "",
                        customerPhone: "",
                        customerEmail: "",
                        jobType: "",
                        priority: "medium",
                        timeFrame: "",
                        estimatedDuration: 60,
                        notes: "",
                        catvProvider: (null == U ? void 0 : null === (e = U.catvProviders) || void 0 === e ? void 0 : e[0]) || "",
                        workSkill: "",
                        originalId: "",
                        scheduleDate: new Date().toISOString().split("T")[0],
                        coordinates: void 0,
                        additionalPhone: "",
                        comment: "",
                        dispatchComment: "",
                        units: void 0,
                        staticStatus: "",
                        staticCompletionTime: "",
                        fullAccountNumber: "",
                        resolutionCodes: ""
                    })
                }
            }
            , [w, P, R, S, T]),
            (0,
            n.useEffect)( () => {
                ez(E || null)
            }
            , [E]);
            let e1 = (0,
            n.useMemo)( () => {
                let e = eQ.trim().toLowerCase();
                return e ? el.filter(t => {
                    let o = "".concat(t.firstName || "", " ").concat(t.lastName || "").trim().toLowerCase()
                      , s = (t.techNumber || t.technumber || t.techId || "").toString().toLowerCase()
                      , r = (t.email || "").toLowerCase();
                    return o.includes(e) || s.includes(e) || r.includes(e)
                }
                ) : el
            }
            , [el, eQ]);
            (0,
            n.useEffect)( () => {
                let e = e => {
                    eH.current && !eH.current.contains(e.target) && e_(!1)
                }
                ;
                return document.addEventListener("mousedown", e),
                () => document.removeEventListener("mousedown", e)
            }
            , []),
            (0,
            n.useEffect)( () => {
                ("audit" === ep || "media" === ep) && P && U && (console.log("".concat(ep, " tab selected, loading logs for job:"), P.jobId),
                e3())
            }
            , [ep, P, U]),
            (0,
            n.useEffect)( () => {
                if (("audit" === ep || "media" === ep) && P && U) {
                    console.log("Setting up real-time audit log listener for ".concat(ep, " tab, job:"), P.jobId);
                    let e = (0,
                    m.doc)(h.db, "companies", U.companyId, "jobs", P.id)
                      , t = (0,
                    m.onSnapshot)(e, e => {
                        if (e.exists()) {
                            let t = C(e.data()).auditLogs || [];
                            console.log("Real-time audit logs update:", t.length, "logs"),
                            ev(t.sort( (e, t) => {
                                let o = new Date(e.timestamp);
                                return new Date(t.timestamp).getTime() - o.getTime()
                            }
                            ))
                        } else
                            console.log("Job document not found for audit logs - job may be archived");
                        eD(!1)
                    }
                    , e => {
                        console.error("Error in audit log listener:", e),
                        eD(!1)
                    }
                    );
                    return () => {
                        console.log("Cleaning up audit log listener"),
                        t()
                    }
                }
            }
            , [ep, P, U]);
            let e3 = async () => {
                if (U && P) {
                    console.log("Loading audit logs for job:", {
                        selectedJobId: P.id,
                        selectedJobJobId: P.jobId,
                        selectedJobAssignedTechId: P.assignedTechId
                    }),
                    eD(!0);
                    try {
                        let e = (0,
                        m.doc)(h.db, "companies", U.companyId, "jobs", P.id)
                          , t = await (0,
                        m.getDoc)(e);
                        if (t.exists()) {
                            let e = t.data()
                              , o = C(e).auditLogs || [];
                            console.log("Retrieved audit logs from job document:", o.length, o);
                            let s = o.sort( (e, t) => {
                                let o = new Date(e.timestamp);
                                return new Date(t.timestamp).getTime() - o.getTime()
                            }
                            );
                            ev(s)
                        } else {
                            console.log("Job document not found in jobs collection, checking archive...");
                            let e = (0,
                            m.collection)(h.db, "companies", U.companyId, "archive")
                              , t = (0,
                            m.query)(e, (0,
                            m.where)("jobId", "==", P.jobId))
                              , o = await (0,
                            m.getDocs)(t);
                            if (o.empty)
                                console.log("Job not found in archive either"),
                                ev([]);
                            else {
                                let e = o.docs[0].data();
                                if (e.auditLogs)
                                    console.log("Found audit logs in archive:", e.auditLogs.length),
                                    ev(e.auditLogs);
                                else if (e.jobData)
                                    try {
                                        let t = JSON.parse(e.jobData);
                                        t.auditLogs ? (console.log("Found audit logs in archived job data:", t.auditLogs.length),
                                        ev(t.auditLogs)) : (console.log("No audit logs found in archived job data"),
                                        ev([]))
                                    } catch (e) {
                                        console.error("Failed to parse archived job data:", e),
                                        ev([])
                                    }
                                else
                                    console.log("No audit logs found in archive"),
                                    ev([])
                            }
                        }
                    } catch (e) {
                        console.error("Error loading audit logs:", e),
                        ev([])
                    } finally {
                        eD(!1)
                    }
                }
            }
              , e4 = e => {
                try {
                    if (!e)
                        return "Unknown";
                    let t = e instanceof Date ? e : new Date(e);
                    if (isNaN(t.getTime()))
                        return "Invalid Date";
                    return t.toLocaleString()
                } catch (e) {
                    return console.error("Error formatting timestamp:", e),
                    "Invalid Date"
                }
            }
              , e5 = (e, t, o) => o && t && "" !== t.trim() ? "Tech #".concat(o, " – ").concat(t) : t && "" !== t.trim() ? e && !o ? t : "Tech #".concat(e, " – ").concat(t) : "Tech #Unknown – Unknown Tech"
              , e8 = e => {
                switch (e.action) {
                case "assigned":
                    let t = e5(e.newUserId, e.newTechName, e.newTechNumber);
                    return "Assigned to ".concat(t);
                case "reassigned":
                    let o = e5(e.previousTechId, e.previousTechName, e.previousTechNumber)
                      , s = e5(e.newUserId, e.newTechName, e.newTechNumber);
                    return "Reassigned from ".concat(o, " to ").concat(s);
                case "internally_reassigned":
                    let r = e5(e.previousTechId, e.previousTechName, e.previousTechNumber)
                      , a = e5(e.newUserId, e.newTechName, e.newTechNumber);
                    return "Internally reassigned from ".concat(r, " to ").concat(a);
                case "completed":
                    return "Completed";
                case "status_changed":
                    return "Status changed from ".concat(e.previousStatus || "Unknown", " to ").concat(e.newStatus || "Unknown");
                case "note_added":
                    return "Note added";
                case "created":
                    if ("Created in Assigned Route" === e.jobOrigin)
                        return "Created and assigned to ".concat(e5(e.newUserId, e.newTechName, e.newTechNumber));
                    if ("Created in Unassigned Route" === e.jobOrigin)
                        return "Created in unassigned route";
                    return "Job created";
                default:
                    return e.action
                }
            }
              , e6 = e => {
                switch (e) {
                case "assigned":
                    return "\uD83D\uDC64";
                case "reassigned":
                case "internally_reassigned":
                    return "\uD83D\uDD04";
                case "completed":
                    return "✅";
                case "status_changed":
                case "note_added":
                    return "\uD83D\uDCDD";
                case "created":
                    return "➕";
                default:
                    return "\uD83D\uDCCB"
                }
            }
              , e7 = (0,
            n.useCallback)( (e, t) => {
                var o;
                if (clearTimeout(b),
                console.log("\uD83D\uDD0D Duplicate check triggered:", {
                    jobNumber: e,
                    catvProvider: t,
                    companyId: null == U ? void 0 : U.id,
                    hasCompany: !!U
                }),
                !e || !(null == U ? void 0 : U.id)) {
                    console.log("❌ Duplicate check skipped - missing jobNumber or companyId"),
                    eS({
                        hasDuplicate: !1
                    });
                    return
                }
                let s = t || (null == U ? void 0 : null === (o = U.catvProviders) || void 0 === o ? void 0 : o[0]) || "";
                if (!s) {
                    console.log("❌ Duplicate check skipped - no catvProvider available"),
                    eS({
                        hasDuplicate: !1
                    });
                    return
                }
                b = setTimeout(async () => {
                    try {
                        console.log("\uD83D\uDD0D Checking duplicate job:", {
                            jobNumber: e,
                            effectiveCatvProvider: s
                        });
                        let t = await x(U.id, e, s);
                        console.log("\uD83D\uDD0D Duplicate check result:", t),
                        eS(t),
                        t.hasDuplicate && eP(!0)
                    } catch (e) {
                        console.error("Error checking duplicate job:", e),
                        eS({
                            hasDuplicate: !1
                        })
                    }
                }
                , 500)
            }
            , [null == U ? void 0 : U.id, null == U ? void 0 : U.catvProviders])
              , e9 = e => {
                let {name: t, value: o} = e.target;
                if (e$(e => ({
                    ...e,
                    [t]: o
                })),
                "jobId" === t || "catvProvider" === t) {
                    let e = "jobId" === t ? o : eK.jobId
                      , s = "catvProvider" === t ? o : eK.catvProvider;
                    console.log("\uD83D\uDD0D Input change triggered duplicate check:", {
                        name: t,
                        value: o,
                        currentJobId: e,
                        currentCatvProvider: s,
                        companyCatvProviders: null == U ? void 0 : U.catvProviders
                    }),
                    e7(e, s)
                }
            }
              , te = e => {
                let {name: t, value: o} = e.target;
                e2(e => ({
                    ...e,
                    [t]: o
                }))
            }
              , tt = () => {
                Q(!0)
            }
            ;
            (0,
            n.useEffect)( () => {
                let e = "create" === ep ? eK.address : e0.address
                  , t = "create" === ep ? eK.city : e0.city;
                e && t ? eY(e, t) : eZ()
            }
            , [eK.address, eK.city, e0.address, e0.city, eY, eZ, ep]),
            (0,
            n.useEffect)( () => {
                console.log("\uD83D\uDD0D UNIFIED: COORDINATE SYNC CHECK:", {
                    isValid: eq.isValid,
                    hasCoordinates: !!eq.coordinates,
                    coordinates: eq.coordinates,
                    activeTab: ep
                }),
                eq.coordinates && eq.isValid && ("create" === ep ? (console.log("✅ UNIFIED: COPYING COORDINATES to formData:", eq.coordinates),
                e$(e => ({
                    ...e,
                    coordinates: eq.coordinates
                }))) : (console.log("✅ UNIFIED: COPYING COORDINATES to editForm:", eq.coordinates),
                e2(e => ({
                    ...e,
                    coordinates: eq.coordinates
                }))))
            }
            , [eq.coordinates, eq.isValid, ep]);
            let to = async () => {
                if (!eU) {
                    eR(!0),
                    eL(!1);
                    try {
                        (null == U ? void 0 : U.companyId) && (B(!0),
                        await new Promise(e => setTimeout(e, 1e3)),
                        B(!1),
                        M({
                            type: "success",
                            title: "Success",
                            body: "Data refreshed successfully"
                        }))
                    } catch (e) {
                        console.error("Error refreshing data:", e),
                        M({
                            type: "error",
                            title: "Error",
                            body: "Failed to refresh data"
                        })
                    } finally {
                        eR(!1),
                        eJ(0)
                    }
                }
            }
              , ts = async e => {
                if (e.preventDefault(),
                !U || !R) {
                    M({
                        title: "Error",
                        body: "Company or user not found",
                        type: "error"
                    });
                    return
                }
                B(!0);
                try {
                    var t, o;
                    if ("tech-route" === T) {
                        if (!eB) {
                            M({
                                title: "Error",
                                body: "Please select a technician to assign this job to",
                                type: "error"
                            });
                            return
                        }
                        if (!eB.techNumber && !eB.techId) {
                            M({
                                title: "Error",
                                body: "Selected technician does not have a valid tech number",
                                type: "error"
                            });
                            return
                        }
                        let e = {
                            ...eK,
                            coordinates: eK.coordinates || eq.coordinates || (0,
                            j.r)(U)
                        };
                        console.log("Creating job with coordinates:", e.coordinates),
                        console.log("FormData coordinates:", eK.coordinates),
                        console.log("ValidationState coordinates:", eq.coordinates);
                        let t = {
                            jobId: e.jobId,
                            type: e.jobType || "installation",
                            address: e.address,
                            unitNumber: e.unitNumber,
                            city: e.city,
                            customerName: e.customerName,
                            customerPhone: e.customerPhone,
                            timeFrame: e.timeFrame,
                            scheduleDate: e.scheduleDate,
                            priority: e.priority,
                            title: e.title,
                            description: e.description,
                            assignedTechId: eB.id,
                            position: e.coordinates,
                            originalId: eK.originalId,
                            catvProvider: eK.catvProvider,
                            source: "manual",
                            additionalPhone: eK.additionalPhone,
                            comment: eK.comment,
                            dispatchComment: eK.dispatchComment,
                            units: eK.units,
                            staticStatus: eK.staticStatus,
                            staticCompletionTime: eK.staticCompletionTime,
                            fullAccountNumber: eK.fullAccountNumber,
                            resolutionCodes: eK.resolutionCodes
                        };
                        console.log("\uD83D\uDE80 UnifiedJobManager - Creating job with request:", t),
                        console.log("\uD83D\uDD0D Starting repeat check for tech-route job:", {
                            companyId: U.companyId,
                            jobId: t.jobId,
                            catvProvider: (null === (o = U.catvProviders) || void 0 === o ? void 0 : o[0]) || ""
                        }),
                        await (0,
                        u.Cq)(U.companyId, t, R.id, "".concat(R.firstName, " ").concat(R.lastName)),
                        M({
                            title: "Job Created",
                            body: "Job ".concat(eK.jobId, " has been created and assigned to ").concat(eB.techNumber || eB.techId, " - ").concat(eB.firstName, " ").concat(eB.lastName),
                            type: "success"
                        })
                    } else if ("unassigned" === T) {
                        let e = {
                            ...eK,
                            coordinates: eK.coordinates || eq.coordinates || (0,
                            j.r)(U)
                        }
                          , t = {
                            jobId: e.jobId,
                            type: e.jobType || "installation",
                            address: e.address,
                            unitNumber: e.unitNumber,
                            city: e.city,
                            customerName: e.customerName,
                            customerPhone: e.customerPhone,
                            timeFrame: e.timeFrame,
                            scheduleDate: e.scheduleDate,
                            priority: e.priority,
                            title: e.title,
                            description: e.description,
                            assignedTechId: "",
                            position: e.coordinates,
                            catvProvider: eK.catvProvider,
                            source: "manual",
                            additionalPhone: eK.additionalPhone,
                            comment: eK.comment,
                            dispatchComment: eK.dispatchComment,
                            units: eK.units,
                            staticStatus: eK.staticStatus,
                            staticCompletionTime: eK.staticCompletionTime,
                            fullAccountNumber: eK.fullAccountNumber,
                            resolutionCodes: eK.resolutionCodes
                        };
                        console.log("\uD83D\uDE80 UnifiedJobManager - Creating unassigned job with request:", t),
                        await (0,
                        u.Cq)(U.companyId, t, R.id, "".concat(R.firstName, " ").concat(R.lastName)),
                        M({
                            title: "Job Created",
                            body: "Job ".concat(eK.jobId, " has been created and added to unassigned jobs"),
                            type: "success"
                        })
                    } else {
                        let e = {
                            ...eK,
                            coordinates: eK.coordinates || eq.coordinates || (0,
                            j.r)(U)
                        }
                          , t = {
                            jobId: e.jobId,
                            type: e.jobType || "installation",
                            address: e.address,
                            unitNumber: e.unitNumber,
                            city: e.city,
                            customerName: e.customerName,
                            customerPhone: e.customerPhone,
                            timeFrame: e.timeFrame,
                            scheduleDate: e.scheduleDate,
                            priority: e.priority,
                            title: e.title,
                            description: e.description,
                            assignedTechId: "",
                            position: e.coordinates,
                            catvProvider: eK.catvProvider,
                            source: "manual",
                            additionalPhone: eK.additionalPhone,
                            comment: eK.comment,
                            dispatchComment: eK.dispatchComment,
                            units: eK.units,
                            staticStatus: eK.staticStatus,
                            staticCompletionTime: eK.staticCompletionTime,
                            fullAccountNumber: eK.fullAccountNumber,
                            resolutionCodes: eK.resolutionCodes
                        };
                        console.log("\uD83D\uDE80 UnifiedJobManager - Creating default job with request:", t),
                        await (0,
                        u.Cq)(U.companyId, t, R.id, "".concat(R.firstName, " ").concat(R.lastName)),
                        M({
                            title: "Job Created",
                            body: "Job ".concat(eK.jobId, " has been created successfully"),
                            type: "success"
                        })
                    }
                    e$({
                        jobId: "",
                        title: "",
                        description: "",
                        address: "",
                        unitNumber: "",
                        city: "",
                        state: "",
                        zipCode: "",
                        customerName: "",
                        customerPhone: "",
                        customerEmail: "",
                        jobType: "",
                        priority: "medium",
                        timeFrame: "",
                        estimatedDuration: 60,
                        notes: "",
                        catvProvider: (null == U ? void 0 : null === (t = U.catvProviders) || void 0 === t ? void 0 : t[0]) || "",
                        originalId: "",
                        scheduleDate: new Date().toISOString().split("T")[0],
                        coordinates: void 0,
                        additionalPhone: "",
                        comment: "",
                        dispatchComment: "",
                        units: void 0,
                        staticStatus: "",
                        staticCompletionTime: "",
                        fullAccountNumber: "",
                        resolutionCodes: ""
                    }),
                    eZ(),
                    I(),
                    k()
                } catch (e) {
                    console.error("Error creating job:", e),
                    M({
                        title: "Error",
                        body: "Failed to create job",
                        type: "error"
                    })
                } finally {
                    B(!1)
                }
            }
              , tr = async () => {
                if (U && R && P) {
                    if (console.log("handleCompleteJob called with job status:", P.status),
                    P.internalReassignment && console.log("Internal action: complete job", {
                        jobId: P.jobId,
                        originalStatus: P.status,
                        internalReassignment: !0
                    }),
                    "completed" === P.status)
                        try {
                            console.log("handleCompleteJob: Reverting completed job to in-progress"),
                            await (0,
                            c.Ql)(U.companyId, P.id, "in-progress", void 0, void 0, void 0, R.id, "".concat(R.firstName, " ").concat(R.lastName), void 0, P.assignedTechId, void 0, void 0, void 0, void 0, U.timezone),
                            M({
                                title: "Job Status Reverted",
                                body: "Job status reverted to in-progress",
                                type: "success"
                            });
                            let e = {
                                ...P,
                                status: "in-progress"
                            };
                            I(e)
                        } catch (e) {
                            console.error("Error reverting job completion:", e),
                            M({
                                title: "Error",
                                body: "Failed to revert job status",
                                type: "error"
                            })
                        }
                    else
                        G(!0)
                }
            }
              , ta = async () => {
                let e, t, o;
                if (U && R && P) {
                    console.log("handleStartJob called with job status:", P.status),
                    P.internalReassignment && console.log("Internal action: start job", {
                        jobId: P.jobId,
                        originalStatus: P.status,
                        internalReassignment: !0
                    }),
                    "in-progress" === P.status ? (e = "assigned",
                    t = "Job Unstarted",
                    o = "Job status reverted to assigned") : "completed" === P.status ? (e = "in-progress",
                    t = "Job Status Reverted",
                    o = "Job status reverted to in-progress") : (e = "in-progress",
                    t = "Job Started",
                    o = "Job status set to in-progress");
                    try {
                        console.log("handleStartJob: Using document ID for job:", P.id),
                        await (0,
                        c.Ql)(U.companyId, P.id, e, void 0, void 0, void 0, R.id, "".concat(R.firstName, " ").concat(R.lastName), void 0, P.assignedTechId, void 0, void 0, void 0, void 0, U.timezone),
                        console.log("handleStartJob: Job status updated successfully"),
                        M({
                            title: t,
                            body: o,
                            type: "success"
                        });
                        let s = {
                            ...P,
                            status: e
                        };
                        I(s)
                    } catch (e) {
                        console.error("Error updating job status:", e),
                        M({
                            title: "Error",
                            body: "Failed to update job status",
                            type: "error"
                        })
                    }
                }
            }
              , tn = async () => {
                if (er.trim() && U && R && P && P.assignedTechId)
                    try {
                        let o = P.assignedTechId
                          , s = (0,
                        m.doc)(h.db, "companies", U.companyId, "routes", o)
                          , r = await (0,
                        m.getDoc)(s);
                        if (r.exists()) {
                            var e, t;
                            let o = r.data().jobs.map(e => e.id === P.id || e.jobId === P.jobId ? {
                                ...e,
                                notes: e.notes ? [...e.notes, {
                                    text: er,
                                    addedBy: "".concat(R.firstName, " ").concat(R.lastName),
                                    addedAt: new Date().toISOString()
                                }] : [{
                                    text: er,
                                    addedBy: "".concat(R.firstName, " ").concat(R.lastName),
                                    addedAt: new Date().toISOString()
                                }],
                                updatedAt: new Date
                            } : e);
                            console.log("UnifiedJobManager - Updating route with new note:", {
                                jobId: P.jobId,
                                notesCount: (null === (t = o.find(e => e.id === P.id || e.jobId === P.jobId)) || void 0 === t ? void 0 : null === (e = t.notes) || void 0 === e ? void 0 : e.length) || 0
                            }),
                            await (0,
                            m.updateDoc)(s, {
                                jobs: o
                            }),
                            M({
                                title: "Note Added",
                                body: "Note has been added to the job successfully",
                                type: "success"
                            }),
                            ea(""),
                            I()
                        }
                    } catch (e) {
                        console.error("Error adding note:", e),
                        M({
                            title: "Error",
                            body: "Failed to add note",
                            type: "error"
                        })
                    }
            }
              , ti = async e => {
                if (U && R && P && P.assignedTechId)
                    try {
                        let t = P.assignedTechId
                          , o = (0,
                        m.doc)(h.db, "companies", U.companyId, "routes", t)
                          , s = await (0,
                        m.getDoc)(o);
                        if (s.exists()) {
                            let t = s.data().jobs.map(t => t.id === P.id || t.jobId === P.jobId ? {
                                ...t,
                                notes: t.notes ? t.notes.filter( (t, o) => o !== e) : [],
                                updatedAt: new Date
                            } : t);
                            await (0,
                            m.updateDoc)(o, {
                                jobs: t
                            }),
                            M({
                                title: "Note Deleted",
                                body: "Note has been deleted successfully",
                                type: "success"
                            }),
                            I()
                        }
                    } catch (e) {
                        console.error("Error deleting note:", e),
                        M({
                            title: "Error",
                            body: "Failed to delete note",
                            type: "error"
                        })
                    }
            }
              , tl = async () => {
                if (!U || !R || !P) {
                    console.log("handleCancelJob: Missing required data", {
                        company: !!U,
                        user: !!R,
                        selectedJob: !!P
                    });
                    return
                }
                if (console.log("handleCancelJob called with job status:", P.status),
                console.log("handleCancelJob: Job details:", {
                    id: P.id,
                    jobId: P.jobId,
                    status: P.status,
                    assignedTechId: P.assignedTechId
                }),
                P.internalReassignment && console.log("Internal action: cancel job", {
                    jobId: P.jobId,
                    originalStatus: P.status,
                    internalReassignment: !0
                }),
                "cancelled" === P.status) {
                    console.log("handleCancelJob: Uncancelling job - reverting to assigned");
                    try {
                        await (0,
                        c.Ql)(U.companyId, P.id, "assigned", void 0, void 0, "Job uncancelled - reverted to assigned status", R.id, "".concat(R.firstName, " ").concat(R.lastName), void 0, "tech" === R.role ? R.id : void 0, void 0, void 0, void 0, void 0, U.timezone),
                        M({
                            title: "Job Status Reverted",
                            body: "Job status reverted to assigned",
                            type: "success"
                        }),
                        console.log("handleCancelJob: Success notification sent");
                        let e = {
                            ...P,
                            status: "assigned"
                        };
                        console.log("handleCancelJob: Calling onJobUpdated with updated job:", e),
                        I(e),
                        console.log("handleCancelJob: onJobUpdated callback completed")
                    } catch (e) {
                        console.error("Error reverting job cancellation:", e),
                        M({
                            title: "Error",
                            body: "Failed to revert job status",
                            type: "error"
                        })
                    }
                } else
                    console.log("handleCancelJob: Opening cancel modal"),
                    Y(!0),
                    console.log("handleCancelJob: setShowCancelModal(true) called")
            }
              , td = async () => {
                if (U && R && P)
                    try {
                        P.archived ? (await (0,
                        c.rY)(U.companyId, P.jobId, R.id, "".concat(R.firstName, " ").concat(R.lastName)),
                        M({
                            title: "Job Unarchived",
                            body: "Job ".concat(P.jobId, " has been unarchived successfully"),
                            type: "success"
                        })) : (await (0,
                        c.XF)(U.companyId, P.jobId, R.id, "".concat(R.firstName, " ").concat(R.lastName)),
                        M({
                            title: "Job Archived",
                            body: "Job ".concat(P.jobId, " has been archived successfully"),
                            type: "success"
                        })),
                        I(),
                        k()
                    } catch (e) {
                        console.error("Error archiving/unarchiving job:", e),
                        M({
                            title: "Error",
                            body: "Failed to ".concat(P.archived ? "unarchive" : "archive", " job"),
                            type: "error"
                        })
                    }
            }
              , tc = async () => {
                if (U && R && P)
                    try {
                        await (0,
                        c.CC)(U.companyId, P.id),
                        M({
                            title: "Job Deleted",
                            body: "Job ".concat(P.jobId, " has been deleted successfully"),
                            type: "success"
                        }),
                        I(),
                        k()
                    } catch (e) {
                        console.error("Error deleting job:", e),
                        M({
                            title: "Error",
                            body: "Failed to delete job",
                            type: "error"
                        })
                    }
            }
              , tu = () => {
                X(!0)
            }
              , tm = async () => {
                X(!1),
                await tc()
            }
              , th = async e => {
                if (e.preventDefault(),
                U && R && P) {
                    B(!0);
                    try {
                        let e;
                        eq.coordinates && !0 === eq.isValid && !eq.isManualLocation ? (console.log("\uD83C\uDFAF UNIFIED: PRIORITY 1 - USING FRESH VALIDATION COORDINATES"),
                        e = eq.coordinates) : e0.coordinates && Array.isArray(e0.coordinates) && 2 === e0.coordinates.length ? (console.log("\uD83C\uDFAF UNIFIED: PRIORITY 2 - USING EDITFORM COORDINATES"),
                        e = e0.coordinates) : eq.isManualLocation && eq.coordinates ? (console.log("\uD83C\uDFAF UNIFIED: PRIORITY 3 - USING MANUAL MAP COORDINATES"),
                        e = eq.coordinates) : P.position && (console.log("⚠️  UNIFIED: FALLBACK - USING CURRENT JOB POSITION"),
                        e = P.position),
                        console.log("\uD83D\uDD04 UNIFIED: Coordinate Sources:"),
                        console.log("  \uD83D\uDCCD validationState.coordinates:", eq.coordinates),
                        console.log("  \uD83D\uDCCD validationState.isValid:", eq.isValid),
                        console.log("  \uD83D\uDCCD editForm.coordinates:", e0.coordinates),
                        console.log("  \uD83D\uDCCD selectedJob.position:", P.position),
                        console.log("  ✅ FINAL coordinates being used:", e);
                        let t = (0,
                        m.doc)(h.db, "companies", U.companyId, "jobs", P.id)
                          , o = {
                            ...Object.fromEntries(Object.entries(e0).filter(e => {
                                let[t,o] = e;
                                return void 0 !== o
                            }
                            )),
                            position: e,
                            updatedAt: new Date,
                            updatedBy: R.id,
                            updatedByName: "".concat(R.firstName, " ").concat(R.lastName)
                        };
                        console.log("\uD83D\uDCBE UNIFIED: Full update data being written:", o),
                        await (0,
                        m.updateDoc)(t, o),
                        M({
                            title: "Job Updated",
                            body: "Job ".concat(P.jobId, " has been updated successfully"),
                            type: "success"
                        }),
                        ef(!1),
                        I()
                    } catch (e) {
                        console.error("Error updating job:", e),
                        M({
                            title: "Error",
                            body: "Failed to update job",
                            type: "error"
                        })
                    } finally {
                        B(!1)
                    }
                }
            }
            ;
            return w && U && U.companyId ? (0,
            a.jsx)("div", {
                className: "fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 ".concat(F ? "p-0" : "p-4"),
                children: (0,
                a.jsxs)("div", {
                    className: "bg-white overflow-hidden ".concat(F ? "fixed inset-0" : "rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh]"),
                    children: [(0,
                    a.jsxs)("div", {
                        className: "flex items-center justify-between p-4 border-b bg-gradient-to-r from-blue-50 to-indigo-50",
                        children: [(0,
                        a.jsxs)("div", {
                            className: "flex items-center space-x-3",
                            children: [(0,
                            a.jsxs)("h2", {
                                className: "text-xl font-bold text-gray-900",
                                children: ["create" === S && "Create New Job", "manage" === S && "Manage Job", "view" === S && "View Job"]
                            }), O && (0,
                            a.jsx)("span", {
                                className: "inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-800 border border-purple-200",
                                children: "\uD83D\uDD27 Altice/Optimum Extended Form"
                            }), (0,
                            a.jsx)("div", {
                                className: "w-px h-6 bg-gray-300"
                            }), (0,
                            a.jsxs)("p", {
                                className: "text-gray-600 font-medium",
                                children: ["tech-route" === T && "Tech Route Management", "unassigned" === T && "Unassigned Jobs", "archive" === T && "Archived Jobs", "map" === T && "Map View"]
                            })]
                        }), (0,
                        a.jsxs)("div", {
                            className: "flex items-center space-x-4",
                            children: ["create" === S && "tech-route" === T && (0,
                            a.jsxs)("div", {
                                className: "flex items-center space-x-2 px-2 py-1.5 rounded-md border ".concat(eB ? "bg-blue-100 border-blue-200" : "bg-red-100 border-red-300"),
                                ref: eH,
                                children: [(0,
                                a.jsx)("svg", {
                                    className: "w-4 h-4 ".concat(eB ? "text-blue-600" : "text-red-600"),
                                    fill: "none",
                                    stroke: "currentColor",
                                    viewBox: "0 0 24 24",
                                    children: (0,
                                    a.jsx)("path", {
                                        strokeLinecap: "round",
                                        strokeLinejoin: "round",
                                        strokeWidth: 2,
                                        d: "M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"
                                    })
                                }), (0,
                                a.jsxs)("div", {
                                    className: "text-xs w-64",
                                    children: [(0,
                                    a.jsxs)("span", {
                                        className: "font-medium ".concat(eB ? "text-blue-900" : "text-red-900"),
                                        children: ["Creating for", (0,
                                        a.jsx)("span", {
                                            className: "text-red-500",
                                            children: "*"
                                        })]
                                    }), (0,
                                    a.jsxs)("div", {
                                        className: "mt-1 relative",
                                        children: [(0,
                                        a.jsx)("input", {
                                            type: "text",
                                            value: eB ? "".concat(eB.firstName, " ").concat(eB.lastName, " (Tech #").concat(eB.techNumber || eB.techId || "Unknown", ")") : eQ,
                                            onChange: e => {
                                                eW(e.target.value),
                                                e_(!0),
                                                eB && ez(null)
                                            }
                                            ,
                                            onFocus: () => e_(!0),
                                            placeholder: "Search technicians...",
                                            className: "w-full px-2 py-1 border border-blue-200 rounded-md text-xs placeholder-blue-300 focus:outline-none focus:ring-2 focus:ring-blue-300 focus:border-blue-300",
                                            required: !0
                                        }), eG && (0,
                                        a.jsx)("div", {
                                            className: "absolute z-20 w-full mt-1 bg-white border border-blue-200 rounded-md shadow-md max-h-48 overflow-auto",
                                            children: 0 === e1.length ? (0,
                                            a.jsx)("div", {
                                                className: "px-3 py-2 text-xs text-gray-500",
                                                children: "No technicians found"
                                            }) : e1.map(e => (0,
                                            a.jsxs)("button", {
                                                type: "button",
                                                onClick: () => {
                                                    ez(e),
                                                    e_(!1),
                                                    eW("")
                                                }
                                                ,
                                                className: "w-full text-left px-2 py-1.5 text-xs hover:bg-gray-100 focus:bg-gray-100 focus:outline-none",
                                                children: [e.firstName, " ", e.lastName, " (Tech #", e.techNumber || e.techId || "Unknown", ")"]
                                            }, e.id))
                                        })]
                                    })]
                                })]
                            }), "create" === S && "unassigned" === T && (0,
                            a.jsxs)("div", {
                                className: "flex items-center space-x-2 bg-yellow-100 px-3 py-2 rounded-lg border border-yellow-200",
                                children: [(0,
                                a.jsx)("svg", {
                                    className: "w-4 h-4 text-yellow-600",
                                    fill: "none",
                                    stroke: "currentColor",
                                    viewBox: "0 0 24 24",
                                    children: (0,
                                    a.jsx)("path", {
                                        strokeLinecap: "round",
                                        strokeLinejoin: "round",
                                        strokeWidth: 2,
                                        d: "M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"
                                    })
                                }), (0,
                                a.jsxs)("div", {
                                    className: "text-sm",
                                    children: [(0,
                                    a.jsx)("span", {
                                        className: "font-medium text-yellow-900",
                                        children: "Creating for:"
                                    }), (0,
                                    a.jsx)("span", {
                                        className: "ml-1 text-yellow-700",
                                        children: "Unassigned Jobs"
                                    })]
                                })]
                            }), "create" === S && "map" === T && (0,
                            a.jsxs)("div", {
                                className: "flex items-center space-x-2 bg-green-100 px-3 py-2 rounded-lg border border-green-200",
                                children: [(0,
                                a.jsx)("svg", {
                                    className: "w-4 h-4 text-green-600",
                                    fill: "none",
                                    stroke: "currentColor",
                                    viewBox: "0 0 24 24",
                                    children: (0,
                                    a.jsx)("path", {
                                        strokeLinecap: "round",
                                        strokeLinejoin: "round",
                                        strokeWidth: 2,
                                        d: "M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-1.447-.894L15 4m0 13V4m0 0L9 7"
                                    })
                                }), (0,
                                a.jsxs)("div", {
                                    className: "text-sm",
                                    children: [(0,
                                    a.jsx)("span", {
                                        className: "font-medium text-green-900",
                                        children: "Creating for:"
                                    }), (0,
                                    a.jsx)("span", {
                                        className: "ml-1 text-green-700",
                                        children: "Default Tech (001)"
                                    })]
                                })]
                            })]
                        }), (0,
                        a.jsx)("button", {
                            onClick: k,
                            className: "text-gray-400 hover:text-gray-600 transition-colors",
                            children: (0,
                            a.jsx)("svg", {
                                className: "w-6 h-6",
                                fill: "none",
                                stroke: "currentColor",
                                viewBox: "0 0 24 24",
                                children: (0,
                                a.jsx)("path", {
                                    strokeLinecap: "round",
                                    strokeLinejoin: "round",
                                    strokeWidth: 2,
                                    d: "M6 18L18 6M6 6l12 12"
                                })
                            })
                        })]
                    }), "manage" === S && (0,
                    a.jsx)("div", {
                        className: "border-b",
                        children: (0,
                        a.jsxs)("nav", {
                            className: "flex space-x-8 px-6",
                            children: [(0,
                            a.jsx)("button", {
                                onClick: () => eg("manage"),
                                className: "py-4 px-1 border-b-2 font-medium text-sm ".concat("manage" === ep ? "border-blue-500 text-blue-600" : "border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),
                                children: "Manage Job"
                            }), (0,
                            a.jsx)("button", {
                                onClick: () => eg("media"),
                                className: "py-4 px-1 border-b-2 font-medium text-sm ".concat("media" === ep ? "border-blue-500 text-blue-600" : "border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),
                                children: "Job Media"
                            }), (0,
                            a.jsx)("button", {
                                onClick: () => eg("audit"),
                                className: "py-4 px-1 border-b-2 font-medium text-sm ".concat("audit" === ep ? "border-blue-500 text-blue-600" : "border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),
                                children: "Audit Log"
                            }), (0,
                            a.jsx)("button", {
                                onClick: () => eg("notes"),
                                className: "py-4 px-1 border-b-2 font-medium text-sm ".concat("notes" === ep ? "border-blue-500 text-blue-600" : "border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),
                                children: (0,
                                a.jsxs)("div", {
                                    className: "flex items-center space-x-2",
                                    children: [(0,
                                    a.jsx)("span", {
                                        children: "Notes"
                                    }), (null == P ? void 0 : P.notes) && P.notes.length > 0 && (0,
                                    a.jsx)("span", {
                                        className: "inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",
                                        children: P.notes.length
                                    })]
                                })
                            })]
                        })
                    }), (0,
                    a.jsxs)("div", {
                        className: "flex-1 overflow-y-auto p-4 relative",
                        style: {
                            maxHeight: "calc(90vh - 140px)"
                        },
                        onTouchStart: e => {
                            F && (eF(e.touches[0].clientY),
                            eV(e.currentTarget.scrollTop))
                        }
                        ,
                        onTouchMove: e => {
                            if (!F || eU)
                                return;
                            let t = e.touches[0].clientY - eM;
                            if (0 === e.currentTarget.scrollTop && t > 0) {
                                e.preventDefault();
                                let o = Math.min(.5 * t, 100);
                                eJ(o),
                                eL(o > 10)
                            }
                        }
                        ,
                        onTouchEnd: () => {
                            F && !eU && (eA > 60 ? to() : (eL(!1),
                            eJ(0)))
                        }
                        ,
                        children: [(0,
                        a.jsx)( () => F && (eE || eU) ? (0,
                        a.jsx)("div", {
                            className: "absolute top-0 left-0 right-0 flex items-center justify-center bg-blue-50 border-b border-blue-200 transition-all duration-200 z-10",
                            style: {
                                height: "".concat(Math.min(eA, 60), "px"),
                                transform: "translateY(".concat(Math.min(eA - 60, 0), "px)")
                            },
                            children: (0,
                            a.jsx)("div", {
                                className: "flex items-center space-x-2 text-blue-600",
                                children: eU ? (0,
                                a.jsxs)(a.Fragment, {
                                    children: [(0,
                                    a.jsxs)("svg", {
                                        className: "w-5 h-5 animate-spin",
                                        fill: "none",
                                        viewBox: "0 0 24 24",
                                        children: [(0,
                                        a.jsx)("circle", {
                                            className: "opacity-25",
                                            cx: "12",
                                            cy: "12",
                                            r: "10",
                                            stroke: "currentColor",
                                            strokeWidth: "4"
                                        }), (0,
                                        a.jsx)("path", {
                                            className: "opacity-75",
                                            fill: "currentColor",
                                            d: "M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
                                        })]
                                    }), (0,
                                    a.jsx)("span", {
                                        className: "text-sm font-medium",
                                        children: "Refreshing..."
                                    })]
                                }) : (0,
                                a.jsxs)(a.Fragment, {
                                    children: [(0,
                                    a.jsx)("svg", {
                                        className: "w-5 h-5 transition-transform duration-200 ".concat(eA > 60 ? "rotate-180" : ""),
                                        fill: "none",
                                        stroke: "currentColor",
                                        viewBox: "0 0 24 24",
                                        children: (0,
                                        a.jsx)("path", {
                                            strokeLinecap: "round",
                                            strokeLinejoin: "round",
                                            strokeWidth: 2,
                                            d: "M19 14l-7 7m0 0l-7-7m7 7V3"
                                        })
                                    }), (0,
                                    a.jsx)("span", {
                                        className: "text-sm font-medium",
                                        children: eA > 60 ? "Release to refresh" : "Pull to refresh"
                                    })]
                                })
                            })
                        }) : null, {}), P && !0 === P.archived && (0,
                        a.jsx)("div", {
                            className: "mb-4 bg-amber-50 border-l-4 border-amber-400 p-4 rounded-md",
                            children: (0,
                            a.jsxs)("div", {
                                className: "flex",
                                children: [(0,
                                a.jsx)("div", {
                                    className: "flex-shrink-0",
                                    children: (0,
                                    a.jsx)("svg", {
                                        className: "h-5 w-5 text-amber-400",
                                        viewBox: "0 0 20 20",
                                        fill: "currentColor",
                                        children: (0,
                                        a.jsx)("path", {
                                            fillRule: "evenodd",
                                            d: "M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",
                                            clipRule: "evenodd"
                                        })
                                    })
                                }), (0,
                                a.jsx)("div", {
                                    className: "ml-3",
                                    children: (0,
                                    a.jsxs)("p", {
                                        className: "text-sm text-amber-700",
                                        children: [(0,
                                        a.jsx)("strong", {
                                            children: "Job Archived:"
                                        }), " This job is archived and locked. No modifications can be made to archived jobs."]
                                    })
                                })]
                            })
                        }), "create" === ep && "create" === S && (0,
                        a.jsxs)("form", {
                            onSubmit: ts,
                            className: "space-y-4",
                            children: [(0,
                            a.jsxs)("div", {
                                className: "bg-gray-50 p-4 rounded-lg",
                                children: [(0,
                                a.jsx)("h3", {
                                    className: "text-base font-semibold text-gray-900 mb-3",
                                    children: "Job Information"
                                }), (0,
                                a.jsxs)("div", {
                                    className: "space-y-3",
                                    children: [(0,
                                    a.jsxs)("div", {
                                        className: "grid ".concat(F ? "grid-cols-1" : "grid-cols-2", " gap-4"),
                                        children: [(0,
                                        a.jsxs)("div", {
                                            children: [(0,
                                            a.jsx)("label", {
                                                className: "block font-medium text-gray-700 mb-1 ".concat(F ? "text-base" : "text-sm"),
                                                children: "Job Number *"
                                            }), (0,
                                            a.jsxs)("div", {
                                                className: "relative",
                                                children: [(0,
                                                a.jsx)("input", {
                                                    type: "text",
                                                    name: "jobId",
                                                    value: eK.jobId,
                                                    onChange: e9,
                                                    required: !0,
                                                    className: "w-full px-3 ".concat(F ? "py-3 text-base" : "py-2", " border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"),
                                                    placeholder: "e.g., WO-2024-001"
                                                }), eI.hasDuplicate && (0,
                                                a.jsx)("div", {
                                                    className: "absolute right-3 top-1/2 transform -translate-y-1/2",
                                                    children: (0,
                                                    a.jsx)("div", {
                                                        className: "w-4 h-4 bg-blue-500 rounded-full flex items-center justify-center",
                                                        children: (0,
                                                        a.jsx)("svg", {
                                                            className: "w-2 h-2 text-white",
                                                            fill: "currentColor",
                                                            viewBox: "0 0 20 20",
                                                            children: (0,
                                                            a.jsx)("path", {
                                                                fillRule: "evenodd",
                                                                d: "M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",
                                                                clipRule: "evenodd"
                                                            })
                                                        })
                                                    })
                                                })]
                                            }), eI.hasDuplicate && (0,
                                            a.jsx)("div", {
                                                className: "mt-2 p-3 bg-blue-50 border border-blue-200 rounded-md",
                                                children: (0,
                                                a.jsxs)("div", {
                                                    className: "flex items-start",
                                                    children: [(0,
                                                    a.jsx)("div", {
                                                        className: "flex-shrink-0",
                                                        children: (0,
                                                        a.jsx)("svg", {
                                                            className: "h-5 w-5 text-blue-400",
                                                            viewBox: "0 0 20 20",
                                                            fill: "currentColor",
                                                            children: (0,
                                                            a.jsx)("path", {
                                                                fillRule: "evenodd",
                                                                d: "M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",
                                                                clipRule: "evenodd"
                                                            })
                                                        })
                                                    }), (0,
                                                    a.jsxs)("div", {
                                                        className: "ml-3 flex-1",
                                                        children: [(0,
                                                        a.jsx)("h3", {
                                                            className: "text-sm font-medium text-blue-800",
                                                            children: "Duplicate Job Detected"
                                                        }), (0,
                                                        a.jsxs)("div", {
                                                            className: "mt-1 text-sm text-blue-700",
                                                            children: [(0,
                                                            a.jsx)("p", {
                                                                children: eI.message
                                                            }), (0,
                                                            a.jsx)("p", {
                                                                className: "text-xs text-blue-600 mt-1",
                                                                children: eI.suggestion
                                                            })]
                                                        }), (0,
                                                        a.jsxs)("div", {
                                                            className: "mt-2 flex gap-2",
                                                            children: [(0,
                                                            a.jsx)("button", {
                                                                type: "button",
                                                                onClick: () => {
                                                                    if (!eI.duplicateJob) {
                                                                        console.error("❌ Cannot copy duplicate job data - no duplicate job available");
                                                                        return
                                                                    }
                                                                    try {
                                                                        var e;
                                                                        console.log("\uD83D\uDD0D Copying duplicate job data:", eI.duplicateJob);
                                                                        let t = eI.duplicateJob;
                                                                        console.log("\uD83D\uDD0D Unit Number Debug:", {
                                                                            duplicateJobUnitNumber: t.unitNumber,
                                                                            duplicateJobUnitNumberType: typeof t.unitNumber,
                                                                            duplicateJobUnitNumberValue: JSON.stringify(t.unitNumber),
                                                                            isUndefined: void 0 === t.unitNumber,
                                                                            isNull: null === t.unitNumber,
                                                                            isEmpty: "" === t.unitNumber,
                                                                            currentFormUnitNumber: eK.unitNumber,
                                                                            currentFormUnitNumberType: typeof eK.unitNumber
                                                                        });
                                                                        let o = null !== (e = t.unitNumber) && void 0 !== e ? e : eK.unitNumber;
                                                                        console.log("\uD83E\uDDEA Testing nullish coalescing:", {
                                                                            duplicateJobUnitNumber: t.unitNumber,
                                                                            currentFormUnitNumber: eK.unitNumber,
                                                                            resultOfNullishCoalescing: o,
                                                                            resultType: typeof o
                                                                        }),
                                                                        e$(e => {
                                                                            var o;
                                                                            let s = {
                                                                                ...e,
                                                                                address: t.address || e.address,
                                                                                unitNumber: null !== (o = t.unitNumber) && void 0 !== o ? o : e.unitNumber,
                                                                                city: t.city || e.city,
                                                                                customerName: t.customerName || e.customerName,
                                                                                customerPhone: t.customerPhone || e.customerPhone,
                                                                                type: t.type || e.type,
                                                                                description: t.description || e.description,
                                                                                timeFrame: t.timeFrame || e.timeFrame,
                                                                                priority: t.priority || e.priority,
                                                                                additionalPhone: t.additionalPhone || e.additionalPhone,
                                                                                comment: t.comment || e.comment,
                                                                                dispatchComment: t.dispatchComment || e.dispatchComment,
                                                                                units: t.units || e.units,
                                                                                fullAccountNumber: t.fullAccountNumber || e.fullAccountNumber,
                                                                                resolutionCodes: t.resolutionCodes || e.resolutionCodes,
                                                                                workSkill: t.workSkill || e.workSkill,
                                                                                notes: t.notes || e.notes
                                                                            };
                                                                            return console.log("\uD83D\uDD0D Form Data After Copy:", {
                                                                                previousUnitNumber: e.unitNumber,
                                                                                newUnitNumber: s.unitNumber,
                                                                                duplicateUnitNumber: t.unitNumber,
                                                                                entireNewFormData: s
                                                                            }),
                                                                            s
                                                                        }
                                                                        ),
                                                                        setTimeout( () => {
                                                                            console.log("\uD83D\uDD0D UnitNumber Debug - After State Update (async check):", {
                                                                                currentFormDataUnitNumber: eK.unitNumber,
                                                                                formDataType: typeof eK.unitNumber
                                                                            })
                                                                        }
                                                                        , 100),
                                                                        console.log("✅ Duplicate job data copied successfully"),
                                                                        eP(!1),
                                                                        eS({
                                                                            hasDuplicate: !1
                                                                        }),
                                                                        M({
                                                                            title: "Data Copied Successfully",
                                                                            body: "Copied data from existing job ".concat(t.jobId),
                                                                            type: "success"
                                                                        })
                                                                    } catch (e) {
                                                                        console.error("❌ Error copying duplicate job data:", e),
                                                                        M({
                                                                            title: "Error",
                                                                            body: "Failed to copy data from duplicate job",
                                                                            type: "error"
                                                                        })
                                                                    }
                                                                }
                                                                ,
                                                                className: "text-sm bg-blue-100 hover:bg-blue-200 text-blue-800 px-3 py-1 rounded-md transition-colors",
                                                                children: "Copy Information"
                                                            }), (0,
                                                            a.jsx)("button", {
                                                                type: "button",
                                                                onClick: () => {
                                                                    eP(!1),
                                                                    eS({
                                                                        hasDuplicate: !1
                                                                    })
                                                                }
                                                                ,
                                                                className: "text-sm bg-gray-100 hover:bg-gray-200 text-gray-800 px-3 py-1 rounded-md transition-colors",
                                                                children: "Continue Without Copying"
                                                            })]
                                                        })]
                                                    })]
                                                })
                                            })]
                                        }), (0,
                                        a.jsxs)("div", {
                                            children: [(0,
                                            a.jsx)("label", {
                                                className: "block text-sm font-medium text-gray-700 mb-1",
                                                children: "Original ID"
                                            }), (0,
                                            a.jsx)("input", {
                                                type: "text",
                                                name: "originalId",
                                                value: eK.originalId,
                                                onChange: e9,
                                                className: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",
                                                placeholder: "e.g., ORIG-12345"
                                            })]
                                        })]
                                    }), (0,
                                    a.jsxs)("div", {
                                        className: "grid ".concat(F ? "grid-cols-1" : "grid-cols-2", " gap-4"),
                                        children: [(0,
                                        a.jsxs)("div", {
                                            children: [(0,
                                            a.jsx)("label", {
                                                className: "block font-medium text-gray-700 mb-1 ".concat(F ? "text-base" : "text-sm"),
                                                children: "Job Type *"
                                            }), (0,
                                            a.jsxs)("select", {
                                                name: "jobType",
                                                value: eK.jobType,
                                                onChange: e9,
                                                required: !0,
                                                className: "w-full px-3 ".concat(F ? "py-3 text-base" : "py-2", " border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"),
                                                children: [(0,
                                                a.jsx)("option", {
                                                    value: "",
                                                    children: "Select job type"
                                                }), (null == U ? void 0 : U.jobTypes) && U.jobTypes.length > 0 ? U.jobTypes.map(e => (0,
                                                a.jsx)("option", {
                                                    value: e,
                                                    children: e
                                                }, e)) : (0,
                                                a.jsx)("option", {
                                                    value: "",
                                                    disabled: !0,
                                                    children: "No job types configured. Please add job types in Admin Options."
                                                })]
                                            })]
                                        }), (0,
                                        a.jsxs)("div", {
                                            children: [(0,
                                            a.jsx)("label", {
                                                className: "block font-medium text-gray-700 mb-1 ".concat(F ? "text-base" : "text-sm"),
                                                children: "Time Frame"
                                            }), (0,
                                            a.jsx)("input", {
                                                type: "text",
                                                name: "timeFrame",
                                                value: eK.timeFrame,
                                                onChange: e9,
                                                className: "w-full px-3 ".concat(F ? "py-3 text-base" : "py-2", " border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"),
                                                placeholder: "e.g., 9AM-11AM"
                                            })]
                                        }), (0,
                                        a.jsxs)("div", {
                                            children: [(0,
                                            a.jsxs)("label", {
                                                className: "block font-medium text-gray-700 mb-1 ".concat(F ? "text-base" : "text-sm"),
                                                children: ["Schedule Date ", (0,
                                                a.jsx)("span", {
                                                    className: "text-red-500",
                                                    children: "*"
                                                })]
                                            }), (0,
                                            a.jsx)("input", {
                                                type: "date",
                                                name: "scheduleDate",
                                                value: eK.scheduleDate || "",
                                                onChange: e => e$(t => ({
                                                    ...t,
                                                    scheduleDate: e.target.value || new Date().toISOString().split("T")[0]
                                                })),
                                                className: "w-full px-3 ".concat(F ? "py-3 text-base" : "py-2", " border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"),
                                                required: !0
                                            }), (0,
                                            a.jsx)("p", {
                                                className: "mt-1 text-gray-500 ".concat(F ? "text-sm" : "text-xs"),
                                                children: "When this job should be scheduled"
                                            })]
                                        })]
                                    }), (0,
                                    a.jsxs)("div", {
                                        children: [(0,
                                        a.jsx)("label", {
                                            className: "block text-sm font-medium text-gray-700 mb-1",
                                            children: "Description"
                                        }), (0,
                                        a.jsx)("textarea", {
                                            name: "description",
                                            value: eK.description,
                                            onChange: e9,
                                            rows: 2,
                                            className: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",
                                            placeholder: "Job description..."
                                        })]
                                    }), O && (0,
                                    a.jsxs)(a.Fragment, {
                                        children: [(0,
                                        a.jsxs)("div", {
                                            children: [(0,
                                            a.jsx)("label", {
                                                className: "block text-sm font-medium text-gray-700 mb-1",
                                                children: "Comment"
                                            }), (0,
                                            a.jsx)("textarea", {
                                                name: "comment",
                                                value: eK.comment || "",
                                                onChange: e9,
                                                rows: 2,
                                                className: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",
                                                placeholder: "General comment..."
                                            })]
                                        }), (0,
                                        a.jsxs)("div", {
                                            children: [(0,
                                            a.jsx)("label", {
                                                className: "block text-sm font-medium text-gray-700 mb-1",
                                                children: "Dispatch Comment"
                                            }), (0,
                                            a.jsx)("textarea", {
                                                name: "dispatchComment",
                                                value: eK.dispatchComment || "",
                                                onChange: e9,
                                                rows: 2,
                                                className: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",
                                                placeholder: "Dispatch-specific comment..."
                                            })]
                                        })]
                                    })]
                                })]
                            }), (0,
                            a.jsxs)("div", {
                                className: "bg-gray-50 p-4 rounded-lg",
                                children: [(0,
                                a.jsx)("h3", {
                                    className: "text-base font-semibold text-gray-900 mb-3",
                                    children: "Location Information"
                                }), (0,
                                a.jsx)("div", {
                                    className: "space-y-3",
                                    children: (0,
                                    a.jsxs)("div", {
                                        className: "grid grid-cols-1 md:grid-cols-2 gap-4",
                                        children: [(0,
                                        a.jsxs)("div", {
                                            children: [(0,
                                            a.jsx)("label", {
                                                className: "block text-sm font-medium text-gray-700 mb-1",
                                                children: "Address *"
                                            }), (0,
                                            a.jsx)("input", {
                                                type: "text",
                                                name: "address",
                                                value: eK.address,
                                                onChange: e9,
                                                required: !0,
                                                className: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",
                                                placeholder: "Street address"
                                            })]
                                        }), (0,
                                        a.jsxs)("div", {
                                            className: "grid grid-cols-2 gap-3",
                                            children: [(0,
                                            a.jsxs)("div", {
                                                children: [(0,
                                                a.jsx)("label", {
                                                    className: "block text-sm font-medium text-gray-700 mb-1",
                                                    children: "Unit Number"
                                                }), (0,
                                                a.jsx)("input", {
                                                    type: "text",
                                                    name: "unitNumber",
                                                    value: eK.unitNumber,
                                                    onChange: e9,
                                                    className: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",
                                                    placeholder: "Apt, Suite, etc."
                                                })]
                                            }), (0,
                                            a.jsxs)("div", {
                                                children: [(0,
                                                a.jsx)("label", {
                                                    className: "block text-sm font-medium text-gray-700 mb-1",
                                                    children: "City *"
                                                }), (0,
                                                a.jsx)("input", {
                                                    type: "text",
                                                    name: "city",
                                                    value: eK.city,
                                                    onChange: e9,
                                                    required: !0,
                                                    className: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",
                                                    placeholder: "City"
                                                })]
                                            })]
                                        })]
                                    })
                                }), eq.isManualLocation && (0,
                                a.jsx)("div", {
                                    className: "p-2 bg-purple-50 border border-purple-200 rounded-lg",
                                    children: (0,
                                    a.jsx)("p", {
                                        className: "text-sm text-purple-800",
                                        children: "\uD83D\uDCCD Coordinates set manually using map picker"
                                    })
                                }), !eq.isManualLocation && eq.isValidating && (0,
                                a.jsx)("div", {
                                    className: "p-2 bg-blue-50 border border-blue-200 rounded-lg",
                                    children: (0,
                                    a.jsx)("p", {
                                        className: "text-sm text-blue-800",
                                        children: "Validating address..."
                                    })
                                }), !eq.isManualLocation && !0 === eq.isValid && (0,
                                a.jsx)("div", {
                                    className: "p-2 bg-green-50 border border-green-200 rounded-lg",
                                    children: (0,
                                    a.jsxs)("p", {
                                        className: "text-sm text-green-800",
                                        children: ["✓ Address validated successfully", eq.geocodeResult && (0,
                                        a.jsxs)("span", {
                                            className: "block mt-1 font-medium",
                                            children: ["Found: ", eq.geocodeResult.displayName, eq.geocodeResult.state && eq.geocodeResult.postcode && " (".concat(eq.geocodeResult.state, " ").concat(eq.geocodeResult.postcode, ")")]
                                        })]
                                    })
                                }), !eq.isManualLocation && !1 === eq.isValid && (0,
                                a.jsx)("div", {
                                    className: "p-2 bg-red-50 border border-red-200 rounded-lg",
                                    children: (0,
                                    a.jsx)("p", {
                                        className: "text-sm text-red-800",
                                        children: "✗ Address not found. Please check the address or use the map picker."
                                    })
                                }), (0,
                                a.jsx)("div", {
                                    className: "flex justify-center mt-3",
                                    children: (0,
                                    a.jsx)("button", {
                                        type: "button",
                                        onClick: tt,
                                        className: "px-4 ".concat(F ? "py-3 text-base" : "py-1.5 text-sm", " bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors"),
                                        children: "\uD83D\uDCCD Use Map Picker"
                                    })
                                })]
                            }), (0,
                            a.jsxs)("div", {
                                className: "bg-gray-50 p-4 rounded-lg",
                                children: [(0,
                                a.jsx)("h3", {
                                    className: "text-base font-semibold text-gray-900 mb-3",
                                    children: "Customer Information"
                                }), (0,
                                a.jsx)("div", {
                                    className: "space-y-3",
                                    children: (0,
                                    a.jsxs)("div", {
                                        className: "grid grid-cols-1 md:grid-cols-2 gap-4",
                                        children: [(0,
                                        a.jsxs)("div", {
                                            children: [(0,
                                            a.jsx)("label", {
                                                className: "block font-medium text-gray-700 mb-1 ".concat(F ? "text-base" : "text-sm"),
                                                children: "Customer Name *"
                                            }), (0,
                                            a.jsx)("input", {
                                                type: "text",
                                                name: "customerName",
                                                value: eK.customerName,
                                                onChange: e9,
                                                required: !0,
                                                className: "w-full px-3 ".concat(F ? "py-3 text-base" : "py-2", " border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"),
                                                placeholder: "Customer name"
                                            })]
                                        }), (0,
                                        a.jsxs)("div", {
                                            children: [(0,
                                            a.jsx)("label", {
                                                className: "block font-medium text-gray-700 mb-1 ".concat(F ? "text-base" : "text-sm"),
                                                children: "Customer Phone"
                                            }), (0,
                                            a.jsx)("input", {
                                                type: "tel",
                                                name: "customerPhone",
                                                value: eK.customerPhone,
                                                onChange: e9,
                                                className: "w-full px-3 ".concat(F ? "py-3 text-base" : "py-2", " border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"),
                                                placeholder: "Phone number"
                                            })]
                                        }), O && (0,
                                        a.jsxs)("div", {
                                            children: [(0,
                                            a.jsx)("label", {
                                                className: "block font-medium text-gray-700 mb-1 ".concat(F ? "text-base" : "text-sm"),
                                                children: "Additional Phone Number"
                                            }), (0,
                                            a.jsx)("input", {
                                                type: "tel",
                                                name: "additionalPhone",
                                                value: eK.additionalPhone || "",
                                                onChange: e9,
                                                className: "w-full px-3 ".concat(F ? "py-3 text-base" : "py-2", " border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"),
                                                placeholder: "Additional phone number"
                                            })]
                                        })]
                                    })
                                })]
                            }), (0,
                            a.jsxs)("div", {
                                className: "bg-blue-50 p-4 rounded-lg border-t border-blue-200",
                                children: [(0,
                                a.jsx)("h3", {
                                    className: "font-semibold text-gray-900 mb-3 ".concat(F ? "text-lg" : "text-base"),
                                    children: "Work Skill Type"
                                }), (0,
                                a.jsxs)("div", {
                                    className: "mb-2 text-blue-600 font-medium ".concat(F ? "text-sm" : "text-xs"),
                                    children: ["\uD83D\uDCA1 Work skills available: ", (null == U ? void 0 : null === (o = U.workSkills) || void 0 === o ? void 0 : o.length) || 0, (null == U ? void 0 : U.workSkills) && " (".concat(U.workSkills.join(", "), ")")]
                                }), (0,
                                a.jsx)("div", {
                                    className: "flex gap-2 flex-wrap",
                                    children: ((null == U ? void 0 : U.workSkills) && U.workSkills.length > 0 ? U.workSkills : ["FTTH", "COAX"]).map(e => (0,
                                    a.jsx)("button", {
                                        type: "button",
                                        onClick: () => {
                                            let t = (eK.workSkill || "").split(",").map(e => e.trim()).filter(e => "" !== e);
                                            if (t.includes(e)) {
                                                let o = t.filter(t => t !== e);
                                                e$(e => ({
                                                    ...e,
                                                    workSkill: o.join(", ")
                                                }))
                                            } else {
                                                let o = [...t, e];
                                                e$(e => ({
                                                    ...e,
                                                    workSkill: o.join(", ")
                                                }))
                                            }
                                        }
                                        ,
                                        className: "px-4 ".concat(F ? "py-3 text-base" : "py-2 text-sm", " font-medium rounded-md border transition-colors ").concat((eK.workSkill || "").includes(e) ? "bg-blue-100 border-blue-300 text-blue-700" : "bg-gray-100 border-gray-300 text-gray-600 hover:bg-gray-200"),
                                        children: e
                                    }, e))
                                }), (0,
                                a.jsxs)("div", {
                                    className: "mt-2 text-gray-500 ".concat(F ? "text-sm" : "text-xs"),
                                    children: ["Selected: ", eK.workSkill || "No skills selected"]
                                })]
                            }), O && (0,
                            a.jsxs)("div", {
                                className: "bg-purple-50 p-4 rounded-lg border-t border-purple-200",
                                children: [(0,
                                a.jsx)("h3", {
                                    className: "font-semibold text-gray-900 mb-3 ".concat(F ? "text-lg" : "text-base"),
                                    children: "Additional Details"
                                }), (0,
                                a.jsxs)("div", {
                                    className: "grid grid-cols-1 md:grid-cols-2 gap-4",
                                    children: [(0,
                                    a.jsxs)("div", {
                                        children: [(0,
                                        a.jsx)("label", {
                                            className: "block font-medium text-gray-700 mb-1 ".concat(F ? "text-base" : "text-sm"),
                                            children: "Units"
                                        }), (0,
                                        a.jsx)("input", {
                                            type: "number",
                                            name: "units",
                                            value: eK.units || "",
                                            onChange: e9,
                                            className: "w-full px-3 ".concat(F ? "py-3 text-base" : "py-2", " border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"),
                                            placeholder: "Number of units",
                                            min: "0"
                                        })]
                                    }), (0,
                                    a.jsxs)("div", {
                                        children: [(0,
                                        a.jsx)("label", {
                                            className: "block font-medium text-gray-700 mb-1 ".concat(F ? "text-base" : "text-sm"),
                                            children: "Status"
                                        }), (0,
                                        a.jsx)("input", {
                                            type: "text",
                                            name: "staticStatus",
                                            value: eK.staticStatus || "",
                                            onChange: e9,
                                            className: "w-full px-3 ".concat(F ? "py-3 text-base" : "py-2", " border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"),
                                            placeholder: "Static status value"
                                        })]
                                    }), (0,
                                    a.jsxs)("div", {
                                        children: [(0,
                                        a.jsx)("label", {
                                            className: "block font-medium text-gray-700 mb-1 ".concat(F ? "text-base" : "text-sm"),
                                            children: "Completion Time"
                                        }), (0,
                                        a.jsx)("input", {
                                            type: "text",
                                            name: "staticCompletionTime",
                                            value: eK.staticCompletionTime || "",
                                            onChange: e9,
                                            className: "w-full px-3 ".concat(F ? "py-3 text-base" : "py-2", " border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"),
                                            placeholder: "Static completion time"
                                        })]
                                    }), (0,
                                    a.jsxs)("div", {
                                        children: [(0,
                                        a.jsx)("label", {
                                            className: "block font-medium text-gray-700 mb-1 ".concat(F ? "text-base" : "text-sm"),
                                            children: "Full Account Number"
                                        }), (0,
                                        a.jsx)("input", {
                                            type: "text",
                                            name: "fullAccountNumber",
                                            value: eK.fullAccountNumber || "",
                                            onChange: e9,
                                            className: "w-full px-3 ".concat(F ? "py-3 text-base" : "py-2", " border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"),
                                            placeholder: "Full account number"
                                        })]
                                    }), (0,
                                    a.jsxs)("div", {
                                        children: [(0,
                                        a.jsx)("label", {
                                            className: "block font-medium text-gray-700 mb-1 ".concat(F ? "text-base" : "text-sm"),
                                            children: "Resolution Codes"
                                        }), (0,
                                        a.jsx)("input", {
                                            type: "text",
                                            name: "resolutionCodes",
                                            value: eK.resolutionCodes || "",
                                            onChange: e9,
                                            className: "w-full px-3 ".concat(F ? "py-3 text-base" : "py-2", " border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"),
                                            placeholder: "Resolution codes"
                                        })]
                                    })]
                                })]
                            }), (0,
                            a.jsxs)("div", {
                                className: "flex justify-end space-x-3 pt-4 border-t border-gray-200",
                                children: [(0,
                                a.jsxs)("button", {
                                    type: "button",
                                    onClick: k,
                                    className: "inline-flex items-center ".concat(F ? "px-6 py-3 text-base" : "px-4 py-2.5", " border border-gray-300 text-gray-700 bg-white rounded-lg hover:bg-gray-50 transition-all duration-200 font-medium shadow-sm hover:shadow-md transform hover:-translate-y-0.5"),
                                    children: [(0,
                                    a.jsx)("svg", {
                                        className: "".concat(F ? "w-6 h-6" : "w-5 h-5", " mr-2"),
                                        fill: "none",
                                        stroke: "currentColor",
                                        viewBox: "0 0 24 24",
                                        children: (0,
                                        a.jsx)("path", {
                                            strokeLinecap: "round",
                                            strokeLinejoin: "round",
                                            strokeWidth: 2,
                                            d: "M6 18L18 6M6 6l12 12"
                                        })
                                    }), "Cancel"]
                                }), (0,
                                a.jsx)("button", {
                                    type: "submit",
                                    disabled: V || "tech-route" === T && !eB,
                                    className: "inline-flex items-center ".concat(F ? "px-6 py-3 text-base" : "px-4 py-2.5", " text-white rounded-lg transition-all duration-200 font-medium shadow-md hover:shadow-lg transform hover:-translate-y-0.5 ").concat(V || "tech-route" === T && !eB ? "opacity-50 cursor-not-allowed bg-gray-500" : "bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800"),
                                    children: V ? (0,
                                    a.jsxs)(a.Fragment, {
                                        children: [(0,
                                        a.jsxs)("svg", {
                                            className: "animate-spin -ml-1 mr-3 ".concat(F ? "h-6 w-6" : "h-5 w-5", " text-white"),
                                            xmlns: "http://www.w3.org/2000/svg",
                                            fill: "none",
                                            viewBox: "0 0 24 24",
                                            children: [(0,
                                            a.jsx)("circle", {
                                                className: "opacity-25",
                                                cx: "12",
                                                cy: "12",
                                                r: "10",
                                                stroke: "currentColor",
                                                strokeWidth: "4"
                                            }), (0,
                                            a.jsx)("path", {
                                                className: "opacity-75",
                                                fill: "currentColor",
                                                d: "M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
                                            })]
                                        }), "Creating..."]
                                    }) : (0,
                                    a.jsxs)(a.Fragment, {
                                        children: [(0,
                                        a.jsx)("svg", {
                                            className: "".concat(F ? "w-6 h-6" : "w-5 h-5", " mr-2"),
                                            fill: "none",
                                            stroke: "currentColor",
                                            viewBox: "0 0 24 24",
                                            children: (0,
                                            a.jsx)("path", {
                                                strokeLinecap: "round",
                                                strokeLinejoin: "round",
                                                strokeWidth: 2,
                                                d: "M12 6v6m0 0v6m0-6h6m-6 0H6"
                                            })
                                        }), "Create Job"]
                                    })
                                })]
                            })]
                        }), "manage" === ep && "manage" === S && P && (0,
                        a.jsxs)("div", {
                            className: "space-y-6",
                            children: [(0,
                            a.jsxs)("div", {
                                className: "bg-gray-50 rounded-lg p-4",
                                children: [(0,
                                a.jsx)("h3", {
                                    className: "text-lg font-medium text-gray-900 mb-4",
                                    children: "Job Details"
                                }), ej ? (0,
                                a.jsxs)("form", {
                                    onSubmit: th,
                                    className: "space-y-4",
                                    children: [(0,
                                    a.jsxs)("div", {
                                        className: "grid grid-cols-1 md:grid-cols-2 gap-4",
                                        children: [(0,
                                        a.jsxs)("div", {
                                            children: [(0,
                                            a.jsx)("label", {
                                                className: "block text-sm font-medium text-gray-700 mb-1",
                                                children: "Job Number"
                                            }), (0,
                                            a.jsx)("input", {
                                                type: "text",
                                                name: "jobId",
                                                value: e0.jobId,
                                                onChange: te,
                                                className: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                            })]
                                        }), (0,
                                        a.jsxs)("div", {
                                            children: [(0,
                                            a.jsx)("label", {
                                                className: "block text-sm font-medium text-gray-700 mb-1",
                                                children: "Job Origin"
                                            }), (0,
                                            a.jsx)("input", {
                                                type: "text",
                                                name: "jobOrigin",
                                                value: e0.jobOrigin,
                                                onChange: te,
                                                className: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",
                                                placeholder: "Enter job origin"
                                            })]
                                        }), (0,
                                        a.jsxs)("div", {
                                            children: [(0,
                                            a.jsx)("label", {
                                                className: "block text-sm font-medium text-gray-700 mb-1",
                                                children: "Job Type"
                                            }), (0,
                                            a.jsx)("input", {
                                                type: "text",
                                                name: "type",
                                                value: e0.type,
                                                onChange: te,
                                                className: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                            })]
                                        }), (0,
                                        a.jsxs)("div", {
                                            children: [(0,
                                            a.jsx)("label", {
                                                className: "block text-sm font-medium text-gray-700 mb-1",
                                                children: "Priority"
                                            }), (0,
                                            a.jsxs)("select", {
                                                name: "priority",
                                                value: e0.priority,
                                                onChange: te,
                                                className: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",
                                                children: [(0,
                                                a.jsx)("option", {
                                                    value: "low",
                                                    children: "Low"
                                                }), (0,
                                                a.jsx)("option", {
                                                    value: "medium",
                                                    children: "Medium"
                                                }), (0,
                                                a.jsx)("option", {
                                                    value: "high",
                                                    children: "High"
                                                }), (0,
                                                a.jsx)("option", {
                                                    value: "urgent",
                                                    children: "Urgent"
                                                })]
                                            })]
                                        }), (0,
                                        a.jsxs)("div", {
                                            children: [(0,
                                            a.jsx)("label", {
                                                className: "block text-sm font-medium text-gray-700 mb-1",
                                                children: "Customer Name"
                                            }), (0,
                                            a.jsx)("input", {
                                                type: "text",
                                                name: "customerName",
                                                value: e0.customerName,
                                                onChange: te,
                                                className: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                            })]
                                        }), (0,
                                        a.jsxs)("div", {
                                            children: [(0,
                                            a.jsx)("label", {
                                                className: "block text-sm font-medium text-gray-700 mb-1",
                                                children: "Customer Phone"
                                            }), (0,
                                            a.jsx)("input", {
                                                type: "tel",
                                                name: "customerPhone",
                                                value: e0.customerPhone,
                                                onChange: te,
                                                className: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                            })]
                                        }), (0,
                                        a.jsxs)("div", {
                                            children: [(0,
                                            a.jsx)("label", {
                                                className: "block text-sm font-medium text-gray-700 mb-1",
                                                children: "Address"
                                            }), (0,
                                            a.jsx)("input", {
                                                type: "text",
                                                name: "address",
                                                value: e0.address,
                                                onChange: te,
                                                className: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                            })]
                                        }), (0,
                                        a.jsxs)("div", {
                                            children: [(0,
                                            a.jsx)("label", {
                                                className: "block text-sm font-medium text-gray-700 mb-1",
                                                children: "Unit Number"
                                            }), (0,
                                            a.jsx)("input", {
                                                type: "text",
                                                name: "unitNumber",
                                                value: e0.unitNumber,
                                                onChange: te,
                                                className: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                            })]
                                        }), (0,
                                        a.jsxs)("div", {
                                            children: [(0,
                                            a.jsx)("label", {
                                                className: "block text-sm font-medium text-gray-700 mb-1",
                                                children: "City"
                                            }), (0,
                                            a.jsx)("input", {
                                                type: "text",
                                                name: "city",
                                                value: e0.city,
                                                onChange: te,
                                                className: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                            })]
                                        }), (0,
                                        a.jsxs)("div", {
                                            children: [(0,
                                            a.jsx)("label", {
                                                className: "block text-sm font-medium text-gray-700 mb-1",
                                                children: "Time Frame"
                                            }), (0,
                                            a.jsx)("input", {
                                                type: "text",
                                                name: "timeFrame",
                                                value: e0.timeFrame,
                                                onChange: te,
                                                className: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                            })]
                                        }), (0,
                                        a.jsxs)("div", {
                                            children: [(0,
                                            a.jsxs)("label", {
                                                className: "block text-sm font-medium text-gray-700 mb-1",
                                                children: ["Schedule Date ", (0,
                                                a.jsx)("span", {
                                                    className: "text-red-500",
                                                    children: "*"
                                                })]
                                            }), (0,
                                            a.jsx)("input", {
                                                type: "date",
                                                name: "scheduleDate",
                                                value: e0.scheduleDate || "",
                                                onChange: e => e2(t => ({
                                                    ...t,
                                                    scheduleDate: e.target.value || new Date().toISOString().split("T")[0]
                                                })),
                                                className: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",
                                                required: !0
                                            })]
                                        }), (0,
                                        a.jsxs)("div", {
                                            className: "md:col-span-2",
                                            children: [(0,
                                            a.jsx)("label", {
                                                className: "block text-sm font-medium text-gray-700 mb-1",
                                                children: "Description"
                                            }), (0,
                                            a.jsx)("textarea", {
                                                name: "description",
                                                value: e0.description || "",
                                                onChange: te,
                                                rows: 3,
                                                className: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",
                                                placeholder: "Job description..."
                                            })]
                                        })]
                                    }), ej && (0,
                                    a.jsxs)(a.Fragment, {
                                        children: [eq.isManualLocation && (0,
                                        a.jsx)("div", {
                                            className: "p-2 bg-purple-50 border border-purple-200 rounded-lg",
                                            children: (0,
                                            a.jsx)("p", {
                                                className: "text-sm text-purple-800",
                                                children: "\uD83D\uDCCD Coordinates set manually using map picker"
                                            })
                                        }), !eq.isManualLocation && eq.isValidating && (0,
                                        a.jsx)("div", {
                                            className: "p-2 bg-blue-50 border border-blue-200 rounded-lg",
                                            children: (0,
                                            a.jsx)("p", {
                                                className: "text-sm text-blue-800",
                                                children: "Validating address..."
                                            })
                                        }), !eq.isManualLocation && !0 === eq.isValid && (0,
                                        a.jsx)("div", {
                                            className: "p-2 bg-green-50 border border-green-200 rounded-lg",
                                            children: (0,
                                            a.jsxs)("p", {
                                                className: "text-sm text-green-800",
                                                children: ["✓ Address validated successfully", eq.geocodeResult && (0,
                                                a.jsxs)("span", {
                                                    className: "block mt-1 font-medium",
                                                    children: ["Found: ", eq.geocodeResult.displayName, eq.geocodeResult.state && eq.geocodeResult.postcode && " (".concat(eq.geocodeResult.state, " ").concat(eq.geocodeResult.postcode, ")")]
                                                })]
                                            })
                                        }), !eq.isManualLocation && !1 === eq.isValid && (0,
                                        a.jsx)("div", {
                                            className: "p-2 bg-red-50 border border-red-200 rounded-lg",
                                            children: (0,
                                            a.jsx)("p", {
                                                className: "text-sm text-red-800",
                                                children: "✗ Address not found. Please check the address or use the map picker."
                                            })
                                        }), (0,
                                        a.jsx)("div", {
                                            className: "flex justify-center mt-3",
                                            children: (0,
                                            a.jsx)("button", {
                                                type: "button",
                                                onClick: tt,
                                                className: "px-3 py-1.5 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors text-sm",
                                                children: "\uD83D\uDCCD Use Map Picker"
                                            })
                                        })]
                                    }), (0,
                                    a.jsxs)("div", {
                                        className: "bg-blue-50 p-4 rounded-lg border-t border-blue-200 mt-4",
                                        children: [(0,
                                        a.jsx)("h3", {
                                            className: "text-base font-semibold text-gray-900 mb-3",
                                            children: "Work Skill Type"
                                        }), (0,
                                        a.jsxs)("div", {
                                            className: "mb-2 text-xs text-blue-600 font-medium",
                                            children: ["\uD83D\uDCA1 Work skills available: ", (null == U ? void 0 : null === (s = U.workSkills) || void 0 === s ? void 0 : s.length) || 0, (null == U ? void 0 : U.workSkills) && " (".concat(U.workSkills.join(", "), ")")]
                                        }), (0,
                                        a.jsx)("div", {
                                            className: "flex gap-2 flex-wrap",
                                            children: ((null == U ? void 0 : U.workSkills) && U.workSkills.length > 0 ? U.workSkills : ["FTTH", "COAX"]).map(e => (0,
                                            a.jsx)("button", {
                                                type: "button",
                                                onClick: () => {
                                                    let t = (e0.workSkill || "").split(",").map(e => e.trim()).filter(e => "" !== e);
                                                    if (t.includes(e)) {
                                                        let o = t.filter(t => t !== e);
                                                        e2(e => ({
                                                            ...e,
                                                            workSkill: o.join(", ")
                                                        }))
                                                    } else {
                                                        let o = [...t, e];
                                                        e2(e => ({
                                                            ...e,
                                                            workSkill: o.join(", ")
                                                        }))
                                                    }
                                                }
                                                ,
                                                className: "px-3 py-2 text-sm font-medium rounded-md border transition-colors ".concat((e0.workSkill || "").includes(e) ? "bg-blue-100 border-blue-300 text-blue-700" : "bg-gray-100 border-gray-300 text-gray-600 hover:bg-gray-200"),
                                                children: e
                                            }, e))
                                        }), (0,
                                        a.jsxs)("div", {
                                            className: "mt-2 text-xs text-gray-500",
                                            children: ["Selected: ", e0.workSkill || "No skills selected"]
                                        })]
                                    }), (0,
                                    a.jsxs)("div", {
                                        className: "flex justify-end space-x-3 pt-4 border-t border-gray-200",
                                        children: [(0,
                                        a.jsxs)("button", {
                                            type: "button",
                                            onClick: () => ef(!1),
                                            className: "inline-flex items-center px-4 py-2.5 border border-gray-300 text-gray-700 bg-white rounded-lg hover:bg-gray-50 transition-all duration-200 font-medium shadow-sm hover:shadow-md transform hover:-translate-y-0.5",
                                            children: [(0,
                                            a.jsx)("svg", {
                                                className: "w-5 h-5 mr-2",
                                                fill: "none",
                                                stroke: "currentColor",
                                                viewBox: "0 0 24 24",
                                                children: (0,
                                                a.jsx)("path", {
                                                    strokeLinecap: "round",
                                                    strokeLinejoin: "round",
                                                    strokeWidth: 2,
                                                    d: "M6 18L18 6M6 6l12 12"
                                                })
                                            }), "Cancel"]
                                        }), (0,
                                        a.jsx)("button", {
                                            type: "submit",
                                            disabled: V,
                                            className: "inline-flex items-center px-4 py-2.5 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-lg hover:from-blue-700 hover:to-blue-800 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed font-medium shadow-md hover:shadow-lg transform hover:-translate-y-0.5",
                                            children: V ? (0,
                                            a.jsxs)(a.Fragment, {
                                                children: [(0,
                                                a.jsxs)("svg", {
                                                    className: "animate-spin -ml-1 mr-3 h-5 w-5 text-white",
                                                    xmlns: "http://www.w3.org/2000/svg",
                                                    fill: "none",
                                                    viewBox: "0 0 24 24",
                                                    children: [(0,
                                                    a.jsx)("circle", {
                                                        className: "opacity-25",
                                                        cx: "12",
                                                        cy: "12",
                                                        r: "10",
                                                        stroke: "currentColor",
                                                        strokeWidth: "4"
                                                    }), (0,
                                                    a.jsx)("path", {
                                                        className: "opacity-75",
                                                        fill: "currentColor",
                                                        d: "M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"
                                                    })]
                                                }), "Updating..."]
                                            }) : (0,
                                            a.jsxs)(a.Fragment, {
                                                children: [(0,
                                                a.jsx)("svg", {
                                                    className: "w-5 h-5 mr-2",
                                                    fill: "none",
                                                    stroke: "currentColor",
                                                    viewBox: "0 0 24 24",
                                                    children: (0,
                                                    a.jsx)("path", {
                                                        strokeLinecap: "round",
                                                        strokeLinejoin: "round",
                                                        strokeWidth: 2,
                                                        d: "M5 13l4 4L19 7"
                                                    })
                                                }), "Update Job"]
                                            })
                                        })]
                                    })]
                                }) : (0,
                                a.jsxs)("div", {
                                    className: "grid grid-cols-1 md:grid-cols-2 gap-4",
                                    children: [(0,
                                    a.jsxs)("div", {
                                        children: [(0,
                                        a.jsx)("p", {
                                            className: "text-sm font-medium text-gray-500",
                                            children: "Job Number"
                                        }), (0,
                                        a.jsx)("p", {
                                            className: "text-sm text-gray-900",
                                            children: (0,
                                            N.mD)(P.jobId, P.catvProvider)
                                        })]
                                    }), (0,
                                    a.jsxs)("div", {
                                        children: [(0,
                                        a.jsx)("p", {
                                            className: "text-sm font-medium text-gray-500",
                                            children: "Job Type"
                                        }), (0,
                                        a.jsx)("p", {
                                            className: "text-sm text-gray-900",
                                            children: P.type || "Not specified"
                                        })]
                                    }), (0,
                                    a.jsxs)("div", {
                                        children: [(0,
                                        a.jsx)("p", {
                                            className: "text-sm font-medium text-gray-500",
                                            children: "Status"
                                        }), (0,
                                        a.jsx)("span", {
                                            className: "inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat("completed" === P.status ? "bg-green-100 text-green-800" : "in-progress" === P.status ? "bg-blue-100 text-blue-800" : "cancelled" === P.status ? "bg-red-100 text-red-800" : "externally_unassigned" === P.status ? "bg-orange-100 text-orange-800" : "bg-gray-100 text-gray-800"),
                                            children: P.status
                                        })]
                                    }), (0,
                                    a.jsxs)("div", {
                                        children: [(0,
                                        a.jsx)("p", {
                                            className: "text-sm font-medium text-gray-500",
                                            children: "Priority"
                                        }), (0,
                                        a.jsx)("span", {
                                            className: "inline-flex px-2 py-1 text-xs font-semibold rounded-full ".concat("emergency" === P.priority ? "bg-red-100 text-red-800" : "urgent" === P.priority ? "bg-red-900 text-red-100" : "high" === P.priority ? "bg-orange-100 text-orange-800" : "medium" === P.priority ? "bg-yellow-100 text-yellow-800" : "bg-green-100 text-green-800"),
                                            children: P.priority || "normal"
                                        })]
                                    }), (0,
                                    a.jsxs)("div", {
                                        children: [(0,
                                        a.jsx)("p", {
                                            className: "text-sm font-medium text-gray-500",
                                            children: "Customer Name"
                                        }), (0,
                                        a.jsx)("p", {
                                            className: "text-sm text-gray-900",
                                            children: P.customerName
                                        })]
                                    }), (0,
                                    a.jsxs)("div", {
                                        children: [(0,
                                        a.jsx)("p", {
                                            className: "text-sm font-medium text-gray-500",
                                            children: "Customer Phone"
                                        }), (0,
                                        a.jsx)("p", {
                                            className: "text-sm text-gray-900",
                                            children: P.customerPhone
                                        })]
                                    }), (0,
                                    a.jsxs)("div", {
                                        className: "md:col-span-2",
                                        children: [(0,
                                        a.jsx)("p", {
                                            className: "text-sm font-medium text-gray-500",
                                            children: "Address"
                                        }), (0,
                                        a.jsxs)("p", {
                                            className: "text-sm text-gray-900",
                                            children: [P.address, P.unitNumber && ", Unit ".concat(P.unitNumber), P.city && ", ".concat(P.city)]
                                        })]
                                    }), (0,
                                    a.jsxs)("div", {
                                        children: [(0,
                                        a.jsx)("p", {
                                            className: "text-sm font-medium text-gray-500",
                                            children: "Time Frame"
                                        }), (0,
                                        a.jsx)("p", {
                                            className: "text-sm text-gray-900",
                                            children: P.timeFrame || "Not specified"
                                        })]
                                    }), (0,
                                    a.jsxs)("div", {
                                        className: "md:col-span-2",
                                        children: [(0,
                                        a.jsx)("p", {
                                            className: "text-sm font-medium text-gray-500",
                                            children: "Description"
                                        }), (0,
                                        a.jsx)("p", {
                                            className: "text-sm text-gray-900",
                                            children: P.description || "Not specified"
                                        })]
                                    }), P.isRepeat && P.repeatInfo && (0,
                                    a.jsx)("div", {
                                        className: "md:col-span-2",
                                        children: (0,
                                        a.jsxs)("div", {
                                            className: "bg-blue-50 border border-blue-200 rounded-lg p-4",
                                            children: [(0,
                                            a.jsxs)("h4", {
                                                className: "text-sm font-semibold text-blue-900 mb-2 flex items-center",
                                                children: [(0,
                                                a.jsx)("svg", {
                                                    className: "w-4 h-4 mr-2",
                                                    fill: "none",
                                                    stroke: "currentColor",
                                                    viewBox: "0 0 24 24",
                                                    children: (0,
                                                    a.jsx)("path", {
                                                        strokeLinecap: "round",
                                                        strokeLinejoin: "round",
                                                        strokeWidth: 2,
                                                        d: "M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"
                                                    })
                                                }), "Repeat Service Call"]
                                            }), (0,
                                            a.jsxs)("div", {
                                                className: "text-sm text-blue-800",
                                                children: [(0,
                                                a.jsxs)("p", {
                                                    className: "mb-2",
                                                    children: [(0,
                                                    a.jsx)("strong", {
                                                        children: "\uD83D\uDCCB Previous Service:"
                                                    }), " This job number was completed ", ( () => {
                                                        let e = P.repeatInfo.daysSinceOriginal;
                                                        return "number" != typeof e ? "" : "".concat(e, " ").concat(1 === e ? "day" : "days", " ago")
                                                    }
                                                    )(), " on ", ( () => {
                                                        try {
                                                            var e;
                                                            let t;
                                                            let o = P.repeatInfo.originalJobDate;
                                                            if (console.log("\uD83D\uDD0D Parsing originalJobDate:", {
                                                                originalDate: o,
                                                                type: typeof o,
                                                                constructor: null == o ? void 0 : null === (e = o.constructor) || void 0 === e ? void 0 : e.name,
                                                                isDate: o instanceof Date,
                                                                hasToDate: !!(null == o ? void 0 : o.toDate)
                                                            }),
                                                            !o)
                                                                return console.log("❌ No originalJobDate provided"),
                                                                "Unknown Date";
                                                            if (o instanceof Date)
                                                                t = o,
                                                                console.log("✅ Using Date object directly");
                                                            else if (o && "object" == typeof o && "function" == typeof o.toDate)
                                                                t = o.toDate(),
                                                                console.log("✅ Using Firestore Timestamp.toDate()");
                                                            else if (o && "object" == typeof o && o.seconds)
                                                                t = new Date(1e3 * o.seconds),
                                                                console.log("✅ Using Firestore Timestamp from seconds");
                                                            else if ("string" == typeof o) {
                                                                if (/^\d{4}-\d{2}-\d{2}$/.test(o)) {
                                                                    let[e,s,r] = o.split("-").map(Number);
                                                                    t = new Date(e,s - 1,r),
                                                                    console.log("✅ Using YYYY-MM-DD string date (timezone-safe)")
                                                                } else
                                                                    t = new Date(o),
                                                                    console.log("✅ Using string date")
                                                            } else {
                                                                if ("number" != typeof o)
                                                                    return console.log("❌ Unknown date format:", o),
                                                                    "Unknown Date";
                                                                t = new Date(o),
                                                                console.log("✅ Using number timestamp")
                                                            }
                                                            if (isNaN(t.getTime()))
                                                                return console.log("❌ Invalid date after parsing"),
                                                                "Invalid Date";
                                                            let s = t.toLocaleDateString("en-US", {
                                                                year: "numeric",
                                                                month: "short",
                                                                day: "numeric"
                                                            });
                                                            return console.log("✅ Successfully formatted date:", s),
                                                            s
                                                        } catch (e) {
                                                            return console.error("❌ Error parsing originalJobDate:", P.repeatInfo.originalJobDate, e),
                                                            "Unknown Date"
                                                        }
                                                    }
                                                    )()]
                                                }), (0,
                                                a.jsxs)("p", {
                                                    className: "text-xs text-blue-600",
                                                    children: [(0,
                                                    a.jsx)("strong", {
                                                        children: "Technician:"
                                                    }), " ", P.repeatInfo.originalTechName || "Unknown Tech", " (", P.repeatInfo.originalTechNumber || "N/A", ")"]
                                                })]
                                            })]
                                        })
                                    }), (0,
                                    a.jsxs)("div", {
                                        children: [(0,
                                        a.jsx)("p", {
                                            className: "text-sm font-medium text-gray-500",
                                            children: "Assigned Tech"
                                        }), (0,
                                        a.jsx)("p", {
                                            className: "text-sm text-gray-900",
                                            children: e5(P.assignedTechId, P.assignedTechName, P.assignedTechNumber)
                                        })]
                                    }), (0,
                                    a.jsxs)("div", {
                                        children: [(0,
                                        a.jsx)("p", {
                                            className: "text-sm font-medium text-gray-500",
                                            children: "Job Origin"
                                        }), (0,
                                        a.jsx)("p", {
                                            className: "text-sm text-gray-900",
                                            children: P.jobOrigin || "Not specified"
                                        })]
                                    }), (0,
                                    a.jsxs)("div", {
                                        children: [(0,
                                        a.jsx)("p", {
                                            className: "text-sm font-medium text-gray-500",
                                            children: "Schedule Date"
                                        }), (0,
                                        a.jsx)("p", {
                                            className: "text-sm text-gray-900",
                                            children: ( () => {
                                                if (!P.scheduleDate)
                                                    return "Not specified";
                                                try {
                                                    let e;
                                                    return e = "string" == typeof P.scheduleDate ? new Date(P.scheduleDate + "T00:00:00") : P.scheduleDate.toDate && "function" == typeof P.scheduleDate.toDate ? P.scheduleDate.toDate() : P.scheduleDate instanceof Date ? P.scheduleDate : new Date(P.scheduleDate.seconds ? 1e3 * P.scheduleDate.seconds : P.scheduleDate),
                                                    isNaN(e.getTime()) ? "Invalid date" : e.toLocaleDateString("en-US", {
                                                        weekday: "long",
                                                        year: "numeric",
                                                        month: "long",
                                                        day: "numeric"
                                                    })
                                                } catch (e) {
                                                    return console.warn("Error displaying scheduleDate:", P.scheduleDate, e),
                                                    "Invalid date"
                                                }
                                            }
                                            )()
                                        })]
                                    }), O && (0,
                                    a.jsxs)(a.Fragment, {
                                        children: [P.fullAccountNumber && (0,
                                        a.jsxs)("div", {
                                            children: [(0,
                                            a.jsx)("p", {
                                                className: "text-sm font-medium text-gray-500",
                                                children: "Full Account Number"
                                            }), (0,
                                            a.jsx)("p", {
                                                className: "text-sm text-gray-900",
                                                children: P.fullAccountNumber
                                            })]
                                        }), P.additionalPhone && (0,
                                        a.jsxs)("div", {
                                            children: [(0,
                                            a.jsx)("p", {
                                                className: "text-sm font-medium text-gray-500",
                                                children: "Additional Phone"
                                            }), (0,
                                            a.jsx)("p", {
                                                className: "text-sm text-gray-900",
                                                children: P.additionalPhone
                                            })]
                                        }), P.comment && (0,
                                        a.jsxs)("div", {
                                            className: "md:col-span-2",
                                            children: [(0,
                                            a.jsx)("p", {
                                                className: "text-sm font-medium text-gray-500",
                                                children: "Comment"
                                            }), (0,
                                            a.jsx)("p", {
                                                className: "text-sm text-gray-900",
                                                children: P.comment
                                            })]
                                        }), P.dispatchComment && (0,
                                        a.jsxs)("div", {
                                            className: "md:col-span-2",
                                            children: [(0,
                                            a.jsx)("p", {
                                                className: "text-sm font-medium text-gray-500",
                                                children: "Dispatch Comment"
                                            }), (0,
                                            a.jsx)("p", {
                                                className: "text-sm text-gray-900",
                                                children: P.dispatchComment
                                            })]
                                        }), P.units && (0,
                                        a.jsxs)("div", {
                                            children: [(0,
                                            a.jsx)("p", {
                                                className: "text-sm font-medium text-gray-500",
                                                children: "Units"
                                            }), (0,
                                            a.jsx)("p", {
                                                className: "text-sm text-gray-900",
                                                children: P.units
                                            })]
                                        }), P.staticStatus && (0,
                                        a.jsxs)("div", {
                                            children: [(0,
                                            a.jsx)("p", {
                                                className: "text-sm font-medium text-gray-500",
                                                children: "Static Status"
                                            }), (0,
                                            a.jsx)("p", {
                                                className: "text-sm text-gray-900",
                                                children: P.staticStatus
                                            })]
                                        }), P.staticCompletionTime && (0,
                                        a.jsxs)("div", {
                                            children: [(0,
                                            a.jsx)("p", {
                                                className: "text-sm font-medium text-gray-500",
                                                children: "Static Completion Time"
                                            }), (0,
                                            a.jsx)("p", {
                                                className: "text-sm text-gray-900",
                                                children: P.staticCompletionTime
                                            })]
                                        }), P.resolutionCodes && (0,
                                        a.jsxs)("div", {
                                            children: [(0,
                                            a.jsx)("p", {
                                                className: "text-sm font-medium text-gray-500",
                                                children: "Resolution Codes"
                                            }), (0,
                                            a.jsx)("p", {
                                                className: "text-sm text-gray-900",
                                                children: P.resolutionCodes
                                            })]
                                        })]
                                    }), P.originalTechId && P.originalTechId !== P.assignedTechId && (0,
                                    a.jsxs)("div", {
                                        children: [(0,
                                        a.jsx)("p", {
                                            className: "text-sm font-medium text-gray-500",
                                            children: "Original Tech"
                                        }), (0,
                                        a.jsx)("p", {
                                            className: "text-sm text-gray-900",
                                            children: e5(P.originalTechId, P.originalTechName, P.originalTechNumber)
                                        })]
                                    })]
                                })]
                            }), (0,
                            a.jsxs)("div", {
                                className: "pt-6 border-t border-gray-200",
                                children: [(0,
                                a.jsxs)("div", {
                                    className: "flex flex-wrap justify-center gap-4",
                                    children: [( () => {
                                        let e = P.assignedTechId
                                          , t = (null == R ? void 0 : R.role) === "dispatcher" || (null == R ? void 0 : R.role) === "admin";
                                        return e || t
                                    }
                                    )() ? (0,
                                    a.jsx)(a.Fragment, {
                                        children: ( () => {
                                            if (P.status === r.REFERENCE || P.status === r.EXTERNALLY_UNASSIGNED)
                                                return (0,
                                                a.jsx)("div", {
                                                    className: "text-center p-4 bg-gray-100 rounded-lg border",
                                                    children: (0,
                                                    a.jsxs)("p", {
                                                        className: "text-sm text-gray-600",
                                                        children: ["Cannot modify ", P.status === r.REFERENCE ? "reference" : "externally unassigned", " job"]
                                                    })
                                                });
                                            let e = P.status === r.ASSIGNED_INTERNAL ? r.ASSIGNED : P.status;
                                            return (0,
                                            a.jsxs)(a.Fragment, {
                                                children: [P.archived && (0,
                                                a.jsx)("div", {
                                                    className: "text-sm text-gray-600 bg-yellow-50 px-4 py-2 rounded-lg border border-yellow-200 mb-3",
                                                    children: "\uD83D\uDCE6 This job is archived - management actions are disabled"
                                                }), (e === r.PENDING || e === r.ASSIGNED || e === r.ASSIGNED_INTERNAL || e === r.IN_PROGRESS) && (0,
                                                a.jsxs)("button", {
                                                    onClick: () => {
                                                        P.archived || (console.log("Start/Unstart button clicked for internal job"),
                                                        console.log("Internal action: start/unstart", {
                                                            jobId: P.jobId,
                                                            originalStatus: P.status,
                                                            effectiveStatus: e
                                                        }),
                                                        ta())
                                                    }
                                                    ,
                                                    disabled: P.archived,
                                                    className: "inline-flex items-center px-3 py-2 rounded-md transition-all duration-200 shadow-sm text-sm font-medium ".concat(P.archived ? "bg-gray-300 text-gray-500 cursor-not-allowed" : "bg-blue-600 text-white hover:bg-blue-700 hover:shadow-md"),
                                                    children: [(0,
                                                    a.jsxs)("svg", {
                                                        className: "w-4 h-4 mr-2",
                                                        fill: "none",
                                                        stroke: "currentColor",
                                                        viewBox: "0 0 24 24",
                                                        children: [(0,
                                                        a.jsx)("path", {
                                                            strokeLinecap: "round",
                                                            strokeLinejoin: "round",
                                                            strokeWidth: 2,
                                                            d: "M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"
                                                        }), (0,
                                                        a.jsx)("path", {
                                                            strokeLinecap: "round",
                                                            strokeLinejoin: "round",
                                                            strokeWidth: 2,
                                                            d: "M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
                                                        })]
                                                    }), e === r.IN_PROGRESS ? "Unstart" : e === r.COMPLETED ? "Unstart" : "Start"]
                                                }), (e === r.IN_PROGRESS || e === r.COMPLETED) && (0,
                                                a.jsxs)("button", {
                                                    onClick: () => {
                                                        P.archived || (console.log("Complete/Undo Complete button clicked for internal job"),
                                                        console.log("Internal action: complete/undo complete", {
                                                            jobId: P.jobId,
                                                            originalStatus: P.status,
                                                            effectiveStatus: e
                                                        }),
                                                        tr())
                                                    }
                                                    ,
                                                    disabled: P.archived,
                                                    className: "inline-flex items-center px-3 py-2 rounded-md transition-all duration-200 shadow-sm text-sm font-medium ".concat(P.archived ? "bg-gray-300 text-gray-500 cursor-not-allowed" : "bg-green-600 text-white hover:bg-green-700 hover:shadow-md"),
                                                    children: [(0,
                                                    a.jsx)("svg", {
                                                        className: "w-4 h-4 mr-2",
                                                        fill: "none",
                                                        stroke: "currentColor",
                                                        viewBox: "0 0 24 24",
                                                        children: (0,
                                                        a.jsx)("path", {
                                                            strokeLinecap: "round",
                                                            strokeLinejoin: "round",
                                                            strokeWidth: 2,
                                                            d: "M5 13l4 4L19 7"
                                                        })
                                                    }), e === r.COMPLETED ? "Undo Complete" : "Complete"]
                                                }), (e === r.PENDING || e === r.ASSIGNED || e === r.ASSIGNED_INTERNAL || e === r.IN_PROGRESS || P.status === r.CANCELLED) && (0,
                                                a.jsxs)("button", {
                                                    onClick: t => {
                                                        P.archived || (t.preventDefault(),
                                                        t.stopPropagation(),
                                                        console.log("Cancel button clicked for internal job"),
                                                        console.log("Button click event:", t),
                                                        console.log("Selected job:", P),
                                                        console.log("Effective status:", e),
                                                        console.log("Internal action: cancel", {
                                                            jobId: P.jobId,
                                                            originalStatus: P.status,
                                                            effectiveStatus: e
                                                        }),
                                                        tl())
                                                    }
                                                    ,
                                                    disabled: P.archived,
                                                    className: "inline-flex items-center px-3 py-2 rounded-md transition-all duration-200 shadow-sm text-sm font-medium ".concat(P.archived ? "bg-gray-300 text-gray-500 cursor-not-allowed" : "bg-red-600 text-white hover:bg-red-700 hover:shadow-md cursor-pointer"),
                                                    style: {
                                                        pointerEvents: "auto",
                                                        zIndex: 10
                                                    },
                                                    children: [(0,
                                                    a.jsx)("svg", {
                                                        className: "w-4 h-4 mr-2",
                                                        fill: "none",
                                                        stroke: "currentColor",
                                                        viewBox: "0 0 24 24",
                                                        children: (0,
                                                        a.jsx)("path", {
                                                            strokeLinecap: "round",
                                                            strokeLinejoin: "round",
                                                            strokeWidth: 2,
                                                            d: "M6 18L18 6M6 6l12 12"
                                                        })
                                                    }), e === r.CANCELLED ? "Uncancel" : "Cancel"]
                                                })]
                                            })
                                        }
                                        )()
                                    }) : (0,
                                    a.jsx)("div", {
                                        className: "text-sm text-gray-600 bg-gray-50 px-4 py-2 rounded-lg",
                                        children: "Job is currently unassigned - assign to technician to access management actions"
                                    }), (0,
                                    a.jsx)("div", {
                                        className: "w-px h-8 bg-gray-300"
                                    }), ((null == R ? void 0 : R.role) === "dispatcher" || (null == R ? void 0 : R.role) === "admin") && (0,
                                    a.jsxs)(a.Fragment, {
                                        children: [(0,
                                        a.jsxs)("button", {
                                            onClick: td,
                                            className: "inline-flex items-center px-3 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 transition-all duration-200 shadow-sm hover:shadow-md text-sm font-medium",
                                            children: [(0,
                                            a.jsx)("svg", {
                                                className: "w-4 h-4 mr-2",
                                                fill: "none",
                                                stroke: "currentColor",
                                                viewBox: "0 0 24 24",
                                                children: (0,
                                                a.jsx)("path", {
                                                    strokeLinecap: "round",
                                                    strokeLinejoin: "round",
                                                    strokeWidth: 2,
                                                    d: "M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"
                                                })
                                            }), P.archived ? "Unarchive" : "Archive"]
                                        }), "completed" !== P.status && "cancelled" !== P.status && "externally_unassigned" !== P.status && !0 !== P.archived && (0,
                                        a.jsxs)("button", {
                                            onClick: () => {
                                                H(!0)
                                            }
                                            ,
                                            className: "inline-flex items-center px-3 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-all duration-200 shadow-sm hover:shadow-md text-sm font-medium",
                                            children: [(0,
                                            a.jsx)("svg", {
                                                className: "w-4 h-4 mr-2",
                                                fill: "none",
                                                stroke: "currentColor",
                                                viewBox: "0 0 24 24",
                                                children: (0,
                                                a.jsx)("path", {
                                                    strokeLinecap: "round",
                                                    strokeLinejoin: "round",
                                                    strokeWidth: 2,
                                                    d: "M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"
                                                })
                                            }), "Reassign"]
                                        })]
                                    })]
                                }), ((null == R ? void 0 : R.role) === "dispatcher" || (null == R ? void 0 : R.role) === "admin") && (0,
                                a.jsx)("div", {
                                    className: "flex justify-end mt-4 pt-4 border-t border-gray-100",
                                    children: (0,
                                    a.jsxs)("div", {
                                        className: "flex gap-3",
                                        children: [(0,
                                        a.jsxs)("button", {
                                            onClick: () => {
                                                P.archived || (console.log("\uD83D\uDCC2 UNIFIED: TOGGLING EDIT MODE for job:", P.jobId, "Current isEditing:", ej),
                                                console.log("\uD83D\uDCC2 UNIFIED: Current job position:", P.position),
                                                ef(!ej))
                                            }
                                            ,
                                            disabled: P.archived,
                                            className: "inline-flex items-center px-3 py-2 rounded-md transition-all duration-200 shadow-sm text-sm font-medium border ".concat(P.archived ? "text-gray-400 bg-gray-50 border-gray-200 cursor-not-allowed" : "text-blue-600 hover:text-blue-800 hover:bg-blue-50 border-blue-200 hover:border-blue-300 hover:shadow-md"),
                                            children: [(0,
                                            a.jsx)("svg", {
                                                className: "w-4 h-4 mr-2",
                                                fill: "none",
                                                stroke: "currentColor",
                                                viewBox: "0 0 24 24",
                                                children: (0,
                                                a.jsx)("path", {
                                                    strokeLinecap: "round",
                                                    strokeLinejoin: "round",
                                                    strokeWidth: 2,
                                                    d: "M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"
                                                })
                                            }), "Edit"]
                                        }), (0,
                                        a.jsxs)("button", {
                                            onClick: () => {
                                                P.archived || tu()
                                            }
                                            ,
                                            disabled: P.archived,
                                            className: "inline-flex items-center px-3 py-2 rounded-md transition-all duration-200 shadow-sm text-sm font-medium border ".concat(P.archived ? "text-gray-400 bg-gray-50 border-gray-200 cursor-not-allowed" : "text-red-600 hover:text-red-800 hover:bg-red-50 border-red-200 hover:border-red-300 hover:shadow-md"),
                                            children: [(0,
                                            a.jsx)("svg", {
                                                className: "w-4 h-4 mr-2",
                                                fill: "none",
                                                stroke: "currentColor",
                                                viewBox: "0 0 24 24",
                                                children: (0,
                                                a.jsx)("path", {
                                                    strokeLinecap: "round",
                                                    strokeLinejoin: "round",
                                                    strokeWidth: 2,
                                                    d: "M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"
                                                })
                                            }), "Delete"]
                                        })]
                                    })
                                })]
                            })]
                        }), "media" === ep && P && (0,
                        a.jsxs)("div", {
                            className: "space-y-6",
                            children: [(0,
                            a.jsx)("h3", {
                                className: "text-lg font-medium text-gray-900",
                                children: "Job Media"
                            }), (0,
                            a.jsxs)("p", {
                                className: "text-sm text-gray-600",
                                children: ["Job Number: ", (0,
                                N.mD)(P.jobId, P.catvProvider)]
                            }), (0,
                            a.jsxs)("div", {
                                className: "space-y-6",
                                children: [( () => {
                                    let e = P.completionPhotos && P.completionPhotos.length > 0
                                      , t = ey && ey.some(e => e.completionPhotos && e.completionPhotos.length > 0);
                                    if (e || t) {
                                        var o;
                                        let e = ((null === (o = P.completionPhotos) || void 0 === o ? void 0 : o.length) || 0) + ((null == ey ? void 0 : ey.reduce( (e, t) => {
                                            var o;
                                            return e + ((null === (o = t.completionPhotos) || void 0 === o ? void 0 : o.length) || 0)
                                        }
                                        , 0)) || 0);
                                        return (0,
                                        a.jsxs)("div", {
                                            className: "bg-white border border-gray-200 rounded-lg shadow-sm",
                                            children: [(0,
                                            a.jsx)("div", {
                                                className: "p-4 border-b border-gray-200",
                                                children: (0,
                                                a.jsxs)("div", {
                                                    className: "flex items-center space-x-3",
                                                    children: [(0,
                                                    a.jsx)("svg", {
                                                        className: "w-5 h-5 text-blue-500",
                                                        fill: "none",
                                                        stroke: "currentColor",
                                                        viewBox: "0 0 24 24",
                                                        children: (0,
                                                        a.jsx)("path", {
                                                            strokeLinecap: "round",
                                                            strokeLinejoin: "round",
                                                            strokeWidth: 2,
                                                            d: "M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"
                                                        })
                                                    }), (0,
                                                    a.jsx)("h4", {
                                                        className: "text-lg font-medium text-gray-900",
                                                        children: "Job Photos"
                                                    }), (0,
                                                    a.jsxs)("span", {
                                                        className: "inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",
                                                        children: [e, " photo", 1 !== e ? "s" : ""]
                                                    })]
                                                })
                                            }), (0,
                                            a.jsxs)("div", {
                                                className: "p-4 space-y-4",
                                                children: [P.completionPhotos && P.completionPhotos.length > 0 && (0,
                                                a.jsx)("div", {
                                                    className: "max-h-[500px] overflow-y-auto",
                                                    children: (0,
                                                    a.jsx)(D.Z, {
                                                        photos: P.completionPhotos,
                                                        jobNumber: P.jobId,
                                                        canDelete: ew,
                                                        onDelete: e => ek("completion", e)
                                                    })
                                                }), ( () => {
                                                    let e = [];
                                                    ey && ey.forEach(t => {
                                                        t.completionPhotos && e.push(...t.completionPhotos)
                                                    }
                                                    );
                                                    let t = P.completionPhotos || []
                                                      , o = e.filter(e => !t.includes(e));
                                                    return 0 === o.length ? null : (0,
                                                    a.jsx)("div", {
                                                        className: "max-h-[500px] overflow-y-auto",
                                                        children: (0,
                                                        a.jsx)(D.Z, {
                                                            photos: o,
                                                            jobNumber: P.jobId
                                                        })
                                                    })
                                                }
                                                )()]
                                            })]
                                        })
                                    }
                                    return (0,
                                    a.jsxs)("div", {
                                        className: "bg-white border border-gray-200 rounded-lg shadow-sm",
                                        children: [(0,
                                        a.jsx)("div", {
                                            className: "p-4 border-b border-gray-200",
                                            children: (0,
                                            a.jsxs)("div", {
                                                className: "flex items-center space-x-3",
                                                children: [(0,
                                                a.jsx)("svg", {
                                                    className: "w-5 h-5 text-gray-400",
                                                    fill: "none",
                                                    stroke: "currentColor",
                                                    viewBox: "0 0 24 24",
                                                    children: (0,
                                                    a.jsx)("path", {
                                                        strokeLinecap: "round",
                                                        strokeLinejoin: "round",
                                                        strokeWidth: 2,
                                                        d: "M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"
                                                    })
                                                }), (0,
                                                a.jsx)("h4", {
                                                    className: "text-lg font-medium text-gray-900",
                                                    children: "Job Photos"
                                                })]
                                            })
                                        }), (0,
                                        a.jsx)("div", {
                                            className: "p-8 text-center",
                                            children: (0,
                                            a.jsx)("p", {
                                                className: "text-gray-500",
                                                children: "No job photos available"
                                            })
                                        })]
                                    })
                                }
                                )(), ( () => {
                                    let e = P.selfQCPhotos && P.selfQCPhotos.length > 0
                                      , t = ey && ey.some(e => e.selfQCPhotos && e.selfQCPhotos.length > 0);
                                    if (e || t) {
                                        var o;
                                        let e = ((null === (o = P.selfQCPhotos) || void 0 === o ? void 0 : o.length) || 0) + ((null == ey ? void 0 : ey.reduce( (e, t) => {
                                            var o;
                                            return e + ((null === (o = t.selfQCPhotos) || void 0 === o ? void 0 : o.length) || 0)
                                        }
                                        , 0)) || 0);
                                        return (0,
                                        a.jsxs)("div", {
                                            className: "bg-white border border-gray-200 rounded-lg shadow-sm",
                                            children: [(0,
                                            a.jsx)("div", {
                                                className: "p-4 border-b border-gray-200",
                                                children: (0,
                                                a.jsxs)("div", {
                                                    className: "flex items-center space-x-3",
                                                    children: [(0,
                                                    a.jsx)("svg", {
                                                        className: "w-5 h-5 text-green-500",
                                                        fill: "none",
                                                        stroke: "currentColor",
                                                        viewBox: "0 0 24 24",
                                                        children: (0,
                                                        a.jsx)("path", {
                                                            strokeLinecap: "round",
                                                            strokeLinejoin: "round",
                                                            strokeWidth: 2,
                                                            d: "M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"
                                                        })
                                                    }), (0,
                                                    a.jsx)("h4", {
                                                        className: "text-lg font-medium text-gray-900",
                                                        children: "Self QC Photos"
                                                    }), (0,
                                                    a.jsxs)("span", {
                                                        className: "inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",
                                                        children: [e, " photo", 1 !== e ? "s" : ""]
                                                    })]
                                                })
                                            }), (0,
                                            a.jsxs)("div", {
                                                className: "p-4 space-y-4",
                                                children: [P.selfQCPhotos && P.selfQCPhotos.length > 0 && (0,
                                                a.jsx)("div", {
                                                    className: "max-h-[500px] overflow-y-auto",
                                                    children: (0,
                                                    a.jsx)(D.Z, {
                                                        photos: P.selfQCPhotos,
                                                        jobNumber: P.jobId,
                                                        canDelete: ew,
                                                        onDelete: e => ek("selfqc", e)
                                                    })
                                                }), ( () => {
                                                    let e = [];
                                                    ey && ey.forEach(t => {
                                                        t.selfQCPhotos && e.push(...t.selfQCPhotos)
                                                    }
                                                    );
                                                    let t = P.selfQCPhotos || []
                                                      , o = e.filter(e => !t.includes(e));
                                                    return 0 === o.length ? null : (0,
                                                    a.jsx)("div", {
                                                        className: "max-h-[500px] overflow-y-auto",
                                                        children: (0,
                                                        a.jsx)(D.Z, {
                                                            photos: o,
                                                            jobNumber: P.jobId
                                                        })
                                                    })
                                                }
                                                )()]
                                            })]
                                        })
                                    }
                                    return (0,
                                    a.jsxs)("div", {
                                        className: "bg-white border border-gray-200 rounded-lg shadow-sm",
                                        children: [(0,
                                        a.jsx)("div", {
                                            className: "p-4 border-b border-gray-200",
                                            children: (0,
                                            a.jsxs)("div", {
                                                className: "flex items-center space-x-3",
                                                children: [(0,
                                                a.jsx)("svg", {
                                                    className: "w-5 h-5 text-gray-400",
                                                    fill: "none",
                                                    stroke: "currentColor",
                                                    viewBox: "0 0 24 24",
                                                    children: (0,
                                                    a.jsx)("path", {
                                                        strokeLinecap: "round",
                                                        strokeLinejoin: "round",
                                                        strokeWidth: 2,
                                                        d: "M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"
                                                    })
                                                }), (0,
                                                a.jsx)("h4", {
                                                    className: "text-lg font-medium text-gray-900",
                                                    children: "Self QC Photos"
                                                })]
                                            })
                                        }), (0,
                                        a.jsx)("div", {
                                            className: "p-8 text-center",
                                            children: (0,
                                            a.jsx)("p", {
                                                className: "text-gray-500",
                                                children: "No self QC photos available"
                                            })
                                        })]
                                    })
                                }
                                )()]
                            })]
                        }), "audit" === ep && P && (0,
                        a.jsxs)("div", {
                            className: "space-y-6",
                            children: [(0,
                            a.jsx)("h3", {
                                className: "text-lg font-medium text-gray-900",
                                children: "Audit Log"
                            }), (0,
                            a.jsxs)("p", {
                                className: "text-sm text-gray-600",
                                children: ["Job Number: ", P.jobId]
                            }), eN ? (0,
                            a.jsxs)("div", {
                                className: "flex items-center justify-center py-8",
                                children: [(0,
                                a.jsx)("div", {
                                    className: "animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"
                                }), (0,
                                a.jsx)("span", {
                                    className: "ml-2 text-gray-600",
                                    children: "Loading audit log..."
                                })]
                            }) : 0 === ey.length ? (0,
                            a.jsxs)("div", {
                                className: "text-center py-8 text-gray-500",
                                children: [(0,
                                a.jsx)("svg", {
                                    className: "mx-auto h-12 w-12 text-gray-400",
                                    fill: "none",
                                    stroke: "currentColor",
                                    viewBox: "0 0 24 24",
                                    children: (0,
                                    a.jsx)("path", {
                                        strokeLinecap: "round",
                                        strokeLinejoin: "round",
                                        strokeWidth: 2,
                                        d: "M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
                                    })
                                }), (0,
                                a.jsx)("h3", {
                                    className: "mt-2 text-sm font-medium text-gray-900",
                                    children: "No audit log entries"
                                }), (0,
                                a.jsx)("p", {
                                    className: "mt-1 text-sm text-gray-500",
                                    children: "No activity has been recorded for this job yet."
                                })]
                            }) : (0,
                            a.jsx)("div", {
                                className: "space-y-4",
                                children: ey.map(e => (0,
                                a.jsx)("div", {
                                    className: "bg-gray-50 rounded-lg p-4 border-l-4 border-blue-500",
                                    children: (0,
                                    a.jsx)("div", {
                                        className: "flex items-start justify-between",
                                        children: (0,
                                        a.jsxs)("div", {
                                            className: "flex items-start space-x-3",
                                            children: [(0,
                                            a.jsx)("div", {
                                                className: "text-2xl",
                                                children: e6(e.action)
                                            }), (0,
                                            a.jsxs)("div", {
                                                className: "flex-1",
                                                children: [(0,
                                                a.jsxs)("div", {
                                                    className: "flex items-center space-x-2",
                                                    children: [(0,
                                                    a.jsx)("h4", {
                                                        className: "font-medium text-gray-900",
                                                        children: e8(e)
                                                    }), (0,
                                                    a.jsx)("span", {
                                                        className: "inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",
                                                        children: e.action.replace("_", " ")
                                                    })]
                                                }), (0,
                                                a.jsxs)("div", {
                                                    className: "mt-2 text-sm text-gray-600 space-y-1",
                                                    children: [(0,
                                                    a.jsxs)("p", {
                                                        children: [(0,
                                                        a.jsx)("span", {
                                                            className: "font-medium",
                                                            children: "Performed by:"
                                                        }), " ", e.performedByUserName || "Unknown"]
                                                    }), (0,
                                                    a.jsxs)("p", {
                                                        children: [(0,
                                                        a.jsx)("span", {
                                                            className: "font-medium",
                                                            children: "Time:"
                                                        }), " ", e.timestamp ? e4(e.timestamp) : "Unknown"]
                                                    }), e.originalTechNumber && (0,
                                                    a.jsxs)("p", {
                                                        children: [(0,
                                                        a.jsx)("span", {
                                                            className: "font-medium",
                                                            children: "Original Tech:"
                                                        }), " ", e.originalTechNumber ? "Tech ".concat(e.originalTechNumber) : "Unknown Tech"]
                                                    }), e.notes && (0,
                                                    a.jsxs)("p", {
                                                        children: [(0,
                                                        a.jsx)("span", {
                                                            className: "font-medium",
                                                            children: "Notes:"
                                                        }), " ", e.notes]
                                                    })]
                                                }), "reassigned" === e.action && (0,
                                                a.jsx)("div", {
                                                    className: "mt-2 p-3 bg-yellow-50 rounded-md border border-yellow-200",
                                                    children: (0,
                                                    a.jsxs)("div", {
                                                        className: "text-sm text-yellow-800",
                                                        children: [(0,
                                                        a.jsxs)("p", {
                                                            children: [(0,
                                                            a.jsx)("span", {
                                                                className: "font-medium",
                                                                children: "Previous Tech:"
                                                            }), " ", e5(e.previousTechId, e.previousTechName, e.previousTechNumber)]
                                                        }), (0,
                                                        a.jsxs)("p", {
                                                            children: [(0,
                                                            a.jsx)("span", {
                                                                className: "font-medium",
                                                                children: "New Tech:"
                                                            }), " ", e5(e.newUserId, e.newTechName, e.newTechNumber)]
                                                        })]
                                                    })
                                                }), "completed" === e.action && e.notes && (0,
                                                a.jsx)("div", {
                                                    className: "mt-2 p-3 bg-green-50 rounded-md border border-green-200",
                                                    children: (0,
                                                    a.jsx)("div", {
                                                        className: "text-sm text-green-800",
                                                        children: (0,
                                                        a.jsxs)("p", {
                                                            children: [(0,
                                                            a.jsx)("span", {
                                                                className: "font-medium",
                                                                children: "Completion notes:"
                                                            }), " ", e.notes]
                                                        })
                                                    })
                                                }), "status_changed" === e.action && (0,
                                                a.jsx)("div", {
                                                    className: "mt-2 p-3 bg-purple-50 rounded-md border border-purple-200",
                                                    children: (0,
                                                    a.jsx)("div", {
                                                        className: "text-sm text-purple-800",
                                                        children: (0,
                                                        a.jsxs)("p", {
                                                            children: [(0,
                                                            a.jsx)("span", {
                                                                className: "font-medium",
                                                                children: "Status change:"
                                                            }), " ", e.previousStatus || "Unknown", " → ", e.newStatus || "Unknown"]
                                                        })
                                                    })
                                                }), "note_added" === e.action && (0,
                                                a.jsx)("div", {
                                                    className: "mt-2 p-3 bg-blue-50 rounded-md border border-blue-200",
                                                    children: (0,
                                                    a.jsxs)("div", {
                                                        className: "text-sm text-blue-800",
                                                        children: [(0,
                                                        a.jsx)("p", {
                                                            children: (0,
                                                            a.jsx)("span", {
                                                                className: "font-medium",
                                                                children: "Note:"
                                                            })
                                                        }), (0,
                                                        a.jsx)("p", {
                                                            className: "mt-1 whitespace-pre-wrap",
                                                            children: e.notes
                                                        })]
                                                    })
                                                }), "created" === e.action && (0,
                                                a.jsx)("div", {
                                                    className: "mt-2 p-3 bg-indigo-50 rounded-md border border-indigo-200",
                                                    children: (0,
                                                    a.jsxs)("div", {
                                                        className: "text-sm text-indigo-800",
                                                        children: [(0,
                                                        a.jsxs)("p", {
                                                            children: [(0,
                                                            a.jsx)("span", {
                                                                className: "font-medium",
                                                                children: "Job Origin:"
                                                            }), " ", e.originalTechNumber ? "Tech ".concat(e.originalTechNumber) : e.newTechNumber ? "Tech ".concat(e.newTechNumber) : "Unknown Tech"]
                                                        }), console.log("\uD83D\uDD0D Audit log originalTechNumber:", e.originalTechNumber, "newTechNumber:", e.newTechNumber)]
                                                    })
                                                })]
                                            })]
                                        })
                                    })
                                }, e.id))
                            })]
                        }), "notes" === ep && P && (0,
                        a.jsxs)("div", {
                            className: "space-y-6",
                            children: [(0,
                            a.jsx)("h3", {
                                className: "text-lg font-medium text-gray-900",
                                children: "Notes"
                            }), (0,
                            a.jsxs)("div", {
                                className: "bg-gray-50 p-4 rounded-lg",
                                children: [(0,
                                a.jsx)("h4", {
                                    className: "text-base font-medium text-gray-900 mb-3",
                                    children: "Add New Note"
                                }), (0,
                                a.jsxs)("div", {
                                    className: "space-y-3",
                                    children: [(0,
                                    a.jsx)("textarea", {
                                        value: er,
                                        onChange: e => ea(e.target.value),
                                        placeholder: "Enter your note here...",
                                        rows: 3,
                                        className: "w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                    }), (0,
                                    a.jsx)("div", {
                                        className: "flex justify-end",
                                        children: (0,
                                        a.jsxs)("button", {
                                            onClick: () => {
                                                !0 !== P.archived && tn()
                                            }
                                            ,
                                            disabled: !er.trim() || !0 === P.archived,
                                            className: "inline-flex items-center px-4 py-2.5 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-lg hover:from-blue-700 hover:to-blue-800 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 shadow-md hover:shadow-lg transform hover:-translate-y-0.5 font-medium",
                                            children: [(0,
                                            a.jsx)("svg", {
                                                className: "w-5 h-5 mr-2",
                                                fill: "none",
                                                stroke: "currentColor",
                                                viewBox: "0 0 24 24",
                                                children: (0,
                                                a.jsx)("path", {
                                                    strokeLinecap: "round",
                                                    strokeLinejoin: "round",
                                                    strokeWidth: 2,
                                                    d: "M12 6v6m0 0v6m0-6h6m-6 0H6"
                                                })
                                            }), "Add Note"]
                                        })
                                    })]
                                })]
                            }), (0,
                            a.jsxs)("div", {
                                className: "space-y-4",
                                children: [(0,
                                a.jsx)("h4", {
                                    className: "text-base font-medium text-gray-900",
                                    children: "Existing Notes"
                                }), ey.filter(e => "note_added" === e.action).length > 0 ? (0,
                                a.jsx)("div", {
                                    className: "space-y-3",
                                    children: ey.filter(e => "note_added" === e.action).map( (e, t) => (0,
                                    a.jsxs)("div", {
                                        className: "bg-white border border-gray-200 rounded-lg p-4",
                                        children: [(0,
                                        a.jsxs)("div", {
                                            className: "flex justify-between items-start mb-2",
                                            children: [(0,
                                            a.jsxs)("div", {
                                                className: "text-sm text-gray-600",
                                                children: [(0,
                                                a.jsx)("span", {
                                                    className: "font-medium",
                                                    children: e.performedByUserName
                                                }), (0,
                                                a.jsx)("span", {
                                                    className: "mx-2",
                                                    children: "•"
                                                }), (0,
                                                a.jsx)("span", {
                                                    children: e.timestamp ? e4(e.timestamp) : "Unknown"
                                                })]
                                            }), (0,
                                            a.jsxs)("button", {
                                                onClick: () => {
                                                    !0 !== P.archived && ti(e.id)
                                                }
                                                ,
                                                disabled: !0 === P.archived,
                                                className: "inline-flex items-center text-red-600 hover:text-red-800 text-sm font-medium hover:bg-red-50 px-2 py-1 rounded transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",
                                                children: [(0,
                                                a.jsx)("svg", {
                                                    className: "w-4 h-4 mr-1",
                                                    fill: "none",
                                                    stroke: "currentColor",
                                                    viewBox: "0 0 24 24",
                                                    children: (0,
                                                    a.jsx)("path", {
                                                        strokeLinecap: "round",
                                                        strokeLinejoin: "round",
                                                        strokeWidth: 2,
                                                        d: "M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"
                                                    })
                                                }), "Delete"]
                                            })]
                                        }), (0,
                                        a.jsx)("p", {
                                            className: "text-gray-900",
                                            children: note.text
                                        })]
                                    }, "note-".concat(e.id || t)))
                                }) : (0,
                                a.jsx)("div", {
                                    className: "bg-gray-50 rounded-lg p-6 text-center",
                                    children: (0,
                                    a.jsx)("p", {
                                        className: "text-gray-500",
                                        children: "No notes added yet"
                                    })
                                })]
                            })]
                        })]
                    }), z && (0,
                    a.jsx)(g.Z, {
                        initialCoordinates: (0,
                        j.r)(U),
                        onLocationSelect: e => {
                            "create" === ep ? e$(t => ({
                                ...t,
                                coordinates: e
                            })) : e2(t => ({
                                ...t,
                                coordinates: e
                            })),
                            eX(e),
                            Q(!1),
                            M({
                                title: "Location Selected",
                                body: "Location has been set from map",
                                type: "success"
                            })
                        }
                        ,
                        onCancel: () => {
                            Q(!1)
                        }
                    }), W && P && (0,
                    a.jsx)(f.Z, {
                        jobId: P.documentId || P.id,
                        jobNumber: P.jobId,
                        jobTitle: P.title || P.description || "Job",
                        externalTechId: P.externalTechId,
                        job: P,
                        isOpen: W,
                        onClose: () => G(!1),
                        onCompleted: () => {
                            G(!1),
                            I({
                                ...P,
                                status: "completed"
                            })
                        }
                    }), _ && P && (0,
                    a.jsx)(y.Z, {
                        isOpen: _,
                        onClose: () => H(!1),
                        job: P,
                        onJobReassigned: () => {
                            H(!1),
                            P && I(P)
                        }
                    }), q && P && (0,
                    a.jsx)(v.Z, {
                        jobId: P.documentId || P.id,
                        jobNumber: P.jobId,
                        jobTitle: P.title,
                        isOpen: q,
                        onClose: () => Y(!1),
                        job: P,
                        onJobCancelled: () => {
                            Y(!1),
                            I({
                                ...P,
                                status: "cancelled"
                            })
                        }
                    }), Z && (0,
                    a.jsx)("div", {
                        className: "modal-container",
                        style: {
                            zIndex: 60
                        },
                        children: (0,
                        a.jsxs)("div", {
                            className: "modal-content max-w-md w-full p-6",
                            children: [(0,
                            a.jsxs)("div", {
                                className: "flex items-center mb-4",
                                children: [(0,
                                a.jsx)("div", {
                                    className: "flex-shrink-0",
                                    children: (0,
                                    a.jsx)("svg", {
                                        className: "h-6 w-6 text-red-600",
                                        fill: "none",
                                        stroke: "currentColor",
                                        viewBox: "0 0 24 24",
                                        children: (0,
                                        a.jsx)("path", {
                                            strokeLinecap: "round",
                                            strokeLinejoin: "round",
                                            strokeWidth: 2,
                                            d: "M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"
                                        })
                                    })
                                }), (0,
                                a.jsx)("div", {
                                    className: "ml-3",
                                    children: (0,
                                    a.jsx)("h3", {
                                        className: "text-lg font-medium text-gray-900",
                                        children: "Delete Job"
                                    })
                                })]
                            }), (0,
                            a.jsx)("div", {
                                className: "mb-6",
                                children: (0,
                                a.jsxs)("p", {
                                    className: "text-sm text-gray-600",
                                    children: ["Are you sure you want to delete job ", (0,
                                    a.jsx)("span", {
                                        className: "font-medium",
                                        children: null == P ? void 0 : P.jobId
                                    }), "? This action cannot be undone."]
                                })
                            }), (0,
                            a.jsxs)("div", {
                                className: "flex justify-end space-x-3",
                                children: [(0,
                                a.jsxs)("button", {
                                    onClick: () => {
                                        X(!1)
                                    }
                                    ,
                                    className: "inline-flex items-center px-4 py-2.5 border border-gray-300 text-gray-700 bg-white rounded-lg hover:bg-gray-50 transition-all duration-200 font-medium shadow-sm hover:shadow-md transform hover:-translate-y-0.5",
                                    children: [(0,
                                    a.jsx)("svg", {
                                        className: "w-5 h-5 mr-2",
                                        fill: "none",
                                        stroke: "currentColor",
                                        viewBox: "0 0 24 24",
                                        children: (0,
                                        a.jsx)("path", {
                                            strokeLinecap: "round",
                                            strokeLinejoin: "round",
                                            strokeWidth: 2,
                                            d: "M6 18L18 6M6 6l12 12"
                                        })
                                    }), "Cancel"]
                                }), (0,
                                a.jsxs)("button", {
                                    onClick: tm,
                                    className: "inline-flex items-center px-4 py-2.5 bg-gradient-to-r from-red-600 to-red-700 text-white rounded-lg hover:from-red-700 hover:to-red-800 transition-all duration-200 font-medium shadow-md hover:shadow-lg transform hover:-translate-y-0.5",
                                    children: [(0,
                                    a.jsx)("svg", {
                                        className: "w-5 h-5 mr-2",
                                        fill: "none",
                                        stroke: "currentColor",
                                        viewBox: "0 0 24 24",
                                        children: (0,
                                        a.jsx)("path", {
                                            strokeLinecap: "round",
                                            strokeLinejoin: "round",
                                            strokeWidth: 2,
                                            d: "M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"
                                        })
                                    }), "Delete"]
                                })]
                            })]
                        })
                    })]
                })
            }) : null
        }
        function C(e) {
            if (!e)
                return e;
            if (Array.isArray(e))
                return e.map(C);
            if ("object" == typeof e) {
                let t = {};
                for (let[o,s] of Object.entries(e))
                    s && "object" == typeof s && "toDate"in s && "function" == typeof s.toDate ? t[o] = s.toDate() : s && "object" == typeof s ? t[o] = C(s) : t[o] = s;
                return t
            }
            return e
        }
    }
}]);
